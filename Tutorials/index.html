<!DOCTYPE html><html><head><meta charset="utf-8"><title>Your First REST API.md</title><style>@charset "UTF-8";@import 'https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0-alpha2/katex.min.css';code{color:#c7254e;background-color:#f9f2f4;border-radius:4px}code,kbd{padding:2px 4px}kbd{color:#fff;background-color:#333;border-radius:3px;box-shadow:inset 0 -1px 0 rgba(0,0,0,.25)}kbd kbd{padding:0;font-size:100%;box-shadow:none}pre{display:block;margin:0 0 10px;word-break:break-all;word-wrap:break-word;color:#333;background-color:#f5f5f5;border:1px solid #ccc;border-radius:4px}pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0}.pre-scrollable{max-height:340px;overflow-y:scroll}table{background-color:transparent}th{text-align:left}.table{width:100%;max-width:100%;margin-bottom:20px}.table>thead>tr>th{padding:8px;line-height:1.4285714;border-top:1px solid #ddd}.table>thead>tr>td,.table>tbody>tr>th,.table>tbody>tr>td,.table>tfoot>tr>th,.table>tfoot>tr>td{padding:8px;line-height:1.4285714;vertical-align:top;border-top:1px solid #ddd}.table>thead>tr>th{vertical-align:bottom;border-bottom:2px solid #ddd}.table>caption+thead>tr:first-child>th,.table>caption+thead>tr:first-child>td,.table>colgroup+thead>tr:first-child>th,.table>colgroup+thead>tr:first-child>td,.table>thead:first-child>tr:first-child>th,.table>thead:first-child>tr:first-child>td{border-top:0}.table>tbody+tbody{border-top:2px solid #ddd}.table .table{background-color:#fff}.table-condensed>thead>tr>th,.table-condensed>thead>tr>td,.table-condensed>tbody>tr>th,.table-condensed>tbody>tr>td,.table-condensed>tfoot>tr>th,.table-condensed>tfoot>tr>td{padding:5px}.table-bordered,.table-bordered>thead>tr>th,.table-bordered>thead>tr>td,.table-bordered>tbody>tr>th,.table-bordered>tbody>tr>td,.table-bordered>tfoot>tr>th,.table-bordered>tfoot>tr>td{border:1px solid #ddd}.table-bordered>thead>tr>th,.table-bordered>thead>tr>td{border-bottom-width:2px}.table-striped>tbody>tr:nth-child(odd)>td,.table-striped>tbody>tr:nth-child(odd)>th{background-color:#f9f9f9}.table-hover>tbody>tr:hover>td,.table-hover>tbody>tr:hover>th{background-color:#f5f5f5}table col[class*="col-"]{position:static;float:none;display:table-column}table td[class*="col-"],table th[class*="col-"]{position:static;float:none;display:table-cell}.table>thead>tr>td.active,.table>thead>tr>th.active,.table>thead>tr.active>td,.table>thead>tr.active>th,.table>tbody>tr>td.active,.table>tbody>tr>th.active,.table>tbody>tr.active>td,.table>tbody>tr.active>th,.table>tfoot>tr>td.active,.table>tfoot>tr>th.active,.table>tfoot>tr.active>td,.table>tfoot>tr.active>th{background-color:#f5f5f5}.table-hover>tbody>tr>td.active:hover,.table-hover>tbody>tr>th.active:hover,.table-hover>tbody>tr.active:hover>td,.table-hover>tbody>tr:hover>.active,.table-hover>tbody>tr.active:hover>th{background-color:#e8e8e8}.table>thead>tr>td.success,.table>thead>tr>th.success,.table>thead>tr.success>td,.table>thead>tr.success>th,.table>tbody>tr>td.success,.table>tbody>tr>th.success,.table>tbody>tr.success>td,.table>tbody>tr.success>th,.table>tfoot>tr>td.success,.table>tfoot>tr>th.success,.table>tfoot>tr.success>td,.table>tfoot>tr.success>th{background-color:#dff0d8}.table-hover>tbody>tr>td.success:hover,.table-hover>tbody>tr>th.success:hover,.table-hover>tbody>tr.success:hover>td,.table-hover>tbody>tr:hover>.success,.table-hover>tbody>tr.success:hover>th{background-color:#d0e9c6}.table>thead>tr>td.info,.table>thead>tr>th.info,.table>thead>tr.info>td,.table>thead>tr.info>th,.table>tbody>tr>td.info,.table>tbody>tr>th.info,.table>tbody>tr.info>td,.table>tbody>tr.info>th,.table>tfoot>tr>td.info,.table>tfoot>tr>th.info,.table>tfoot>tr.info>td,.table>tfoot>tr.info>th{background-color:#d9edf7}.table-hover>tbody>tr>td.info:hover,.table-hover>tbody>tr>th.info:hover,.table-hover>tbody>tr.info:hover>td,.table-hover>tbody>tr:hover>.info,.table-hover>tbody>tr.info:hover>th{background-color:#c4e3f3}.table>thead>tr>td.warning,.table>thead>tr>th.warning,.table>thead>tr.warning>td,.table>thead>tr.warning>th,.table>tbody>tr>td.warning,.table>tbody>tr>th.warning,.table>tbody>tr.warning>td,.table>tbody>tr.warning>th,.table>tfoot>tr>td.warning,.table>tfoot>tr>th.warning,.table>tfoot>tr.warning>td,.table>tfoot>tr.warning>th{background-color:#fcf8e3}.table-hover>tbody>tr>td.warning:hover,.table-hover>tbody>tr>th.warning:hover,.table-hover>tbody>tr.warning:hover>td,.table-hover>tbody>tr:hover>.warning,.table-hover>tbody>tr.warning:hover>th{background-color:#faf2cc}.table>thead>tr>td.danger,.table>thead>tr>th.danger,.table>thead>tr.danger>td,.table>thead>tr.danger>th,.table>tbody>tr>td.danger,.table>tbody>tr>th.danger,.table>tbody>tr.danger>td,.table>tbody>tr.danger>th,.table>tfoot>tr>td.danger,.table>tfoot>tr>th.danger,.table>tfoot>tr.danger>td,.table>tfoot>tr.danger>th{background-color:#f2dede}.table-hover>tbody>tr>td.danger:hover,.table-hover>tbody>tr>th.danger:hover,.table-hover>tbody>tr.danger:hover>td,.table-hover>tbody>tr:hover>.danger,.table-hover>tbody>tr.danger:hover>th{background-color:#ebcccc}fieldset{border:0;min-width:0}legend{display:block;width:100%;margin-bottom:20px;font-size:21px;line-height:inherit;color:#333;border-bottom:1px solid #e5e5e5}label{display:inline-block;max-width:100%;margin-bottom:5px;font-weight:700}input[type="radio"],input[type="checkbox"]{margin:4px 0 0;margin-top:1px \9;line-height:normal}input[type="file"]{display:block}input[type="range"]{display:block;width:100%}select[multiple],select[size]{height:auto}input[type="file"]:focus,input[type="radio"]:focus,input[type="checkbox"]:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}output{padding-top:7px}output,.form-control{display:block;font-size:14px;line-height:1.4285714;color:#555}.form-control{width:100%;height:34px;padding:6px 12px;background-color:#fff;background-image:none;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);transition:border-color ease-in-out .15s,box-shadow ease-in-out .15s}.form-control:focus{border-color:#66afe9;outline:0;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 8px rgba(102,175,233,.6)}.form-control::-moz-placeholder{color:#777;opacity:1}.form-control:-ms-input-placeholder{color:#777}.form-control::-webkit-input-placeholder{color:#777}.form-control[disabled],.form-control[readonly],fieldset[disabled] .form-control{cursor:not-allowed;background-color:#eee;opacity:1}textarea.form-control{height:auto}input[type="date"],input[type="time"],input[type="datetime-local"],input[type="month"]{line-height:34px;line-height:1.4285714 \0}input[type="date"].input-sm,.form-horizontal .form-group-sm input.form-control[type="date"],.input-group-sm>input.form-control[type="date"],.input-group-sm>input.input-group-addon[type="date"],.input-group-sm>.input-group-btn>input.btn[type="date"],input[type="time"].input-sm,.form-horizontal .form-group-sm input.form-control[type="time"],.input-group-sm>input.form-control[type="time"],.input-group-sm>input.input-group-addon[type="time"],.input-group-sm>.input-group-btn>input.btn[type="time"],input[type="datetime-local"].input-sm,.form-horizontal .form-group-sm input.form-control[type="datetime-local"],.input-group-sm>input.form-control[type="datetime-local"],.input-group-sm>input.input-group-addon[type="datetime-local"],.input-group-sm>.input-group-btn>input.btn[type="datetime-local"],input[type="month"].input-sm,.form-horizontal .form-group-sm input.form-control[type="month"],.input-group-sm>input.form-control[type="month"],.input-group-sm>input.input-group-addon[type="month"],.input-group-sm>.input-group-btn>input.btn[type="month"]{line-height:30px}input[type="date"].input-lg,.form-horizontal .form-group-lg input.form-control[type="date"],.input-group-lg>input.form-control[type="date"],.input-group-lg>input.input-group-addon[type="date"],.input-group-lg>.input-group-btn>input.btn[type="date"],input[type="time"].input-lg,.form-horizontal .form-group-lg input.form-control[type="time"],.input-group-lg>input.form-control[type="time"],.input-group-lg>input.input-group-addon[type="time"],.input-group-lg>.input-group-btn>input.btn[type="time"],input[type="datetime-local"].input-lg,.form-horizontal .form-group-lg input.form-control[type="datetime-local"],.input-group-lg>input.form-control[type="datetime-local"],.input-group-lg>input.input-group-addon[type="datetime-local"],.input-group-lg>.input-group-btn>input.btn[type="datetime-local"],input[type="month"].input-lg,.form-horizontal .form-group-lg input.form-control[type="month"],.input-group-lg>input.form-control[type="month"],.input-group-lg>input.input-group-addon[type="month"],.input-group-lg>.input-group-btn>input.btn[type="month"]{line-height:46px}.form-group{margin-bottom:15px}.radio,.checkbox{position:relative;display:block;min-height:20px;margin-top:10px;margin-bottom:10px}.radio label,.checkbox label{padding-left:20px;margin-bottom:0;font-weight:400;cursor:pointer}.radio input[type="radio"],.radio-inline input[type="radio"],.checkbox input[type="checkbox"],.checkbox-inline input[type="checkbox"]{position:absolute;margin-left:-20px;margin-top:4px \9}.radio+.radio,.checkbox+.checkbox{margin-top:-5px}.radio-inline,.checkbox-inline{display:inline-block;padding-left:20px;margin-bottom:0;vertical-align:middle;font-weight:400;cursor:pointer}.radio-inline+.radio-inline,.checkbox-inline+.checkbox-inline{margin-top:0;margin-left:10px}input[type="radio"][disabled],input[type="radio"].disabled,fieldset[disabled] input[type="radio"],input[type="checkbox"][disabled],input[type="checkbox"].disabled,fieldset[disabled] input[type="checkbox"],.radio-inline.disabled,fieldset[disabled] .radio-inline,.checkbox-inline.disabled,fieldset[disabled] .checkbox-inline,.radio.disabled label,fieldset[disabled] .radio label,.checkbox.disabled label,fieldset[disabled] .checkbox label{cursor:not-allowed}.form-control-static{padding-top:7px;padding-bottom:7px;margin-bottom:0}.form-control-static.input-lg,.form-horizontal .form-group-lg .form-control-static.form-control,.input-group-lg>.form-control-static.form-control,.input-group-lg>.form-control-static.input-group-addon,.input-group-lg>.input-group-btn>.form-control-static.btn,.form-control-static.input-sm,.form-horizontal .form-group-sm .form-control-static.form-control,.input-group-sm>.form-control-static.form-control,.input-group-sm>.form-control-static.input-group-addon,.input-group-sm>.input-group-btn>.form-control-static.btn{padding-left:0;padding-right:0}.input-sm,.form-horizontal .form-group-sm .form-control,.input-group-sm>.form-control{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}.input-group-sm>.input-group-addon{height:30px;line-height:1.5}.input-group-sm>.input-group-btn>.btn{height:30px;padding:5px 10px;font-size:12px;line-height:1.5;border-radius:3px}select.input-sm,.form-horizontal .form-group-sm select.form-control,.input-group-sm>select.form-control,.input-group-sm>select.input-group-addon,.input-group-sm>.input-group-btn>select.btn{height:30px;line-height:30px}textarea.input-sm,.form-horizontal .form-group-sm textarea.form-control,.input-group-sm>textarea.form-control,.input-group-sm>textarea.input-group-addon,.input-group-sm>.input-group-btn>textarea.btn,select[multiple].input-sm,.form-horizontal .form-group-sm select.form-control[multiple],.input-group-sm>select.form-control[multiple],.input-group-sm>select.input-group-addon[multiple],.input-group-sm>.input-group-btn>select.btn[multiple]{height:auto}.input-lg,.form-horizontal .form-group-lg .form-control,.input-group-lg>.form-control{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}.input-group-lg>.input-group-addon{height:46px;line-height:1.33}.input-group-lg>.input-group-btn>.btn{height:46px;padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}select.input-lg,.form-horizontal .form-group-lg select.form-control,.input-group-lg>select.form-control,.input-group-lg>select.input-group-addon,.input-group-lg>.input-group-btn>select.btn{height:46px;line-height:46px}textarea.input-lg,.form-horizontal .form-group-lg textarea.form-control,.input-group-lg>textarea.form-control,.input-group-lg>textarea.input-group-addon,.input-group-lg>.input-group-btn>textarea.btn,select[multiple].input-lg,.form-horizontal .form-group-lg select.form-control[multiple],.input-group-lg>select.form-control[multiple],.input-group-lg>select.input-group-addon[multiple],.input-group-lg>.input-group-btn>select.btn[multiple]{height:auto}.has-feedback{position:relative}.has-feedback .form-control{padding-right:42.5px}.form-control-feedback{position:absolute;top:25px;right:0;z-index:2;display:block;width:34px;height:34px;line-height:34px;text-align:center}.input-lg+.form-control-feedback,.form-horizontal .form-group-lg .form-control+.form-control-feedback,.input-group-lg>.form-control+.form-control-feedback,.input-group-lg>.input-group-addon+.form-control-feedback,.input-group-lg>.input-group-btn>.btn+.form-control-feedback{width:46px;height:46px;line-height:46px}.input-sm+.form-control-feedback,.form-horizontal .form-group-sm .form-control+.form-control-feedback,.input-group-sm>.form-control+.form-control-feedback,.input-group-sm>.input-group-addon+.form-control-feedback,.input-group-sm>.input-group-btn>.btn+.form-control-feedback{width:30px;height:30px;line-height:30px}.has-success .help-block,.has-success .control-label,.has-success .radio,.has-success .checkbox,.has-success .radio-inline,.has-success .checkbox-inline{color:#3c763d}.has-success .form-control{border-color:#3c763d;box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-success .form-control:focus{border-color:#2b542c;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #67b168}.has-success .input-group-addon{color:#3c763d;border-color:#3c763d;background-color:#dff0d8}.has-success .form-control-feedback{color:#3c763d}.has-warning .help-block,.has-warning .control-label,.has-warning .radio,.has-warning .checkbox,.has-warning .radio-inline,.has-warning .checkbox-inline{color:#8a6d3b}.has-warning .form-control{border-color:#8a6d3b;box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-warning .form-control:focus{border-color:#66512c;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #c0a16b}.has-warning .input-group-addon{color:#8a6d3b;border-color:#8a6d3b;background-color:#fcf8e3}.has-warning .form-control-feedback{color:#8a6d3b}.has-error .help-block,.has-error .control-label,.has-error .radio,.has-error .checkbox,.has-error .radio-inline,.has-error .checkbox-inline{color:#a94442}.has-error .form-control{border-color:#a94442;box-shadow:inset 0 1px 1px rgba(0,0,0,.075)}.has-error .form-control:focus{border-color:#843534;box-shadow:inset 0 1px 1px rgba(0,0,0,.075),0 0 6px #ce8483}.has-error .input-group-addon{color:#a94442;border-color:#a94442;background-color:#f2dede}.has-error .form-control-feedback{color:#a94442}.has-feedback label.sr-only~.form-control-feedback{top:0}.help-block{display:block;margin-top:5px;margin-bottom:10px;color:#737373}.form-horizontal .radio,.form-horizontal .checkbox,.form-horizontal .radio-inline,.form-horizontal .checkbox-inline{margin-top:0;margin-bottom:0;padding-top:7px}.form-horizontal .radio,.form-horizontal .checkbox{min-height:27px}.form-horizontal .form-group{margin-left:-15px;margin-right:-15px}.form-horizontal .form-group:before{content:" ";display:table}.form-horizontal .form-group:after{content:" ";display:table;clear:both}.form-horizontal .has-feedback .form-control-feedback{top:0;right:15px}.btn{display:inline-block;vertical-align:middle;cursor:pointer;background-image:none;border:1px solid transparent;white-space:nowrap;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.btn:focus,.btn:active:focus,.btn.active:focus{outline:thin dotted;outline:5px auto -webkit-focus-ring-color;outline-offset:-2px}.btn:hover,.btn:focus{color:#333;text-decoration:none}.btn:active,.btn.active{outline:0;background-image:none;box-shadow:inset 0 3px 5px rgba(0,0,0,.125)}.btn.disabled,.btn[disabled],fieldset[disabled] .btn{cursor:not-allowed;pointer-events:none;opacity:.65;filter:alpha(opacity=65);box-shadow:none}.btn-default{color:#333;background-color:#fff;border-color:#ccc}.btn-default:hover,.btn-default:focus,.btn-default:active,.btn-default.active,.open>.btn-default.dropdown-toggle{color:#333;background-color:#e6e6e6;border-color:#adadad}.btn-default:active,.btn-default.active,.open>.btn-default.dropdown-toggle{background-image:none}.btn-default.disabled,.btn-default.disabled:hover,.btn-default.disabled:focus,.btn-default.disabled:active,.btn-default.disabled.active,.btn-default[disabled],.btn-default[disabled]:hover,.btn-default[disabled]:focus,.btn-default[disabled]:active,.btn-default[disabled].active,fieldset[disabled] .btn-default,fieldset[disabled] .btn-default:hover,fieldset[disabled] .btn-default:focus,fieldset[disabled] .btn-default:active,fieldset[disabled] .btn-default.active{background-color:#fff;border-color:#ccc}.btn-default .badge{color:#fff;background-color:#333}.btn-primary{color:#fff;background-color:#428bca;border-color:#357ebd}.btn-primary:hover,.btn-primary:focus,.btn-primary:active,.btn-primary.active,.open>.btn-primary.dropdown-toggle{color:#fff;background-color:#3071a9;border-color:#285e8e}.btn-primary:active,.btn-primary.active,.open>.btn-primary.dropdown-toggle{background-image:none}.btn-primary.disabled,.btn-primary.disabled:hover,.btn-primary.disabled:focus,.btn-primary.disabled:active,.btn-primary.disabled.active,.btn-primary[disabled],.btn-primary[disabled]:hover,.btn-primary[disabled]:focus,.btn-primary[disabled]:active,.btn-primary[disabled].active,fieldset[disabled] .btn-primary,fieldset[disabled] .btn-primary:hover,fieldset[disabled] .btn-primary:focus,fieldset[disabled] .btn-primary:active,fieldset[disabled] .btn-primary.active{background-color:#428bca;border-color:#357ebd}.btn-primary .badge{color:#428bca;background-color:#fff}.btn-success{color:#fff;background-color:#5cb85c;border-color:#4cae4c}.btn-success:hover,.btn-success:focus,.btn-success:active,.btn-success.active,.open>.btn-success.dropdown-toggle{color:#fff;background-color:#449d44;border-color:#398439}.btn-success:active,.btn-success.active,.open>.btn-success.dropdown-toggle{background-image:none}.btn-success.disabled,.btn-success.disabled:hover,.btn-success.disabled:focus,.btn-success.disabled:active,.btn-success.disabled.active,.btn-success[disabled],.btn-success[disabled]:hover,.btn-success[disabled]:focus,.btn-success[disabled]:active,.btn-success[disabled].active,fieldset[disabled] .btn-success,fieldset[disabled] .btn-success:hover,fieldset[disabled] .btn-success:focus,fieldset[disabled] .btn-success:active,fieldset[disabled] .btn-success.active{background-color:#5cb85c;border-color:#4cae4c}.btn-success .badge{color:#5cb85c;background-color:#fff}.btn-info{color:#fff;background-color:#5bc0de;border-color:#46b8da}.btn-info:hover,.btn-info:focus,.btn-info:active,.btn-info.active,.open>.btn-info.dropdown-toggle{color:#fff;background-color:#31b0d5;border-color:#269abc}.btn-info:active,.btn-info.active,.open>.btn-info.dropdown-toggle{background-image:none}.btn-info.disabled,.btn-info.disabled:hover,.btn-info.disabled:focus,.btn-info.disabled:active,.btn-info.disabled.active,.btn-info[disabled],.btn-info[disabled]:hover,.btn-info[disabled]:focus,.btn-info[disabled]:active,.btn-info[disabled].active,fieldset[disabled] .btn-info,fieldset[disabled] .btn-info:hover,fieldset[disabled] .btn-info:focus,fieldset[disabled] .btn-info:active,fieldset[disabled] .btn-info.active{background-color:#5bc0de;border-color:#46b8da}.btn-info .badge{color:#5bc0de;background-color:#fff}.btn-warning{color:#fff;background-color:#f0ad4e;border-color:#eea236}.btn-warning:hover,.btn-warning:focus,.btn-warning:active,.btn-warning.active,.open>.btn-warning.dropdown-toggle{color:#fff;background-color:#ec971f;border-color:#d58512}.btn-warning:active,.btn-warning.active,.open>.btn-warning.dropdown-toggle{background-image:none}.btn-warning.disabled,.btn-warning.disabled:hover,.btn-warning.disabled:focus,.btn-warning.disabled:active,.btn-warning.disabled.active,.btn-warning[disabled],.btn-warning[disabled]:hover,.btn-warning[disabled]:focus,.btn-warning[disabled]:active,.btn-warning[disabled].active,fieldset[disabled] .btn-warning,fieldset[disabled] .btn-warning:hover,fieldset[disabled] .btn-warning:focus,fieldset[disabled] .btn-warning:active,fieldset[disabled] .btn-warning.active{background-color:#f0ad4e;border-color:#eea236}.btn-warning .badge{color:#f0ad4e;background-color:#fff}.btn-danger{color:#fff;background-color:#d9534f;border-color:#d43f3a}.btn-danger:hover,.btn-danger:focus,.btn-danger:active,.btn-danger.active,.open>.btn-danger.dropdown-toggle{color:#fff;background-color:#c9302c;border-color:#ac2925}.btn-danger:active,.btn-danger.active,.open>.btn-danger.dropdown-toggle{background-image:none}.btn-danger.disabled,.btn-danger.disabled:hover,.btn-danger.disabled:focus,.btn-danger.disabled:active,.btn-danger.disabled.active,.btn-danger[disabled],.btn-danger[disabled]:hover,.btn-danger[disabled]:focus,.btn-danger[disabled]:active,.btn-danger[disabled].active,fieldset[disabled] .btn-danger,fieldset[disabled] .btn-danger:hover,fieldset[disabled] .btn-danger:focus,fieldset[disabled] .btn-danger:active,fieldset[disabled] .btn-danger.active{background-color:#d9534f;border-color:#d43f3a}.btn-danger .badge{color:#d9534f;background-color:#fff}.btn-link{color:#428bca;font-weight:400;cursor:pointer;border-radius:0}.btn-link,.btn-link:active,.btn-link[disabled],fieldset[disabled] .btn-link{background-color:transparent;box-shadow:none}.btn-link,.btn-link:hover,.btn-link:focus,.btn-link:active{border-color:transparent}.btn-link:hover,.btn-link:focus{color:#2a6496;text-decoration:underline;background-color:transparent}.btn-link[disabled]:hover,.btn-link[disabled]:focus,fieldset[disabled] .btn-link:hover,fieldset[disabled] .btn-link:focus{color:#777;text-decoration:none}.btn-lg{padding:10px 16px;font-size:18px;line-height:1.33;border-radius:6px}.btn-sm{padding:5px 10px}.btn-sm,.btn-xs{font-size:12px;line-height:1.5;border-radius:3px}.btn-xs{padding:1px 5px}.btn-block{display:block;width:100%}.btn-block+.btn-block{margin-top:5px}input[type="submit"].btn-block,input[type="reset"].btn-block,input[type="button"].btn-block{width:100%}.fade{opacity:0;transition:opacity .15s linear}.fade.in{opacity:1}.collapse{display:none}.collapse.in{display:block}tr.collapse.in{display:table-row}tbody.collapse.in{display:table-row-group}.collapsing{position:relative;height:0;overflow:hidden;transition:height .35s ease}.input-group{position:relative;display:table;border-collapse:separate}.input-group[class*="col-"]{float:none;padding-left:0;padding-right:0}.input-group .form-control{position:relative;z-index:2;float:left;width:100%;margin-bottom:0}.input-group-addon,.input-group-btn,.input-group .form-control{display:table-cell}.input-group-addon:not(:first-child):not(:last-child),.input-group-btn:not(:first-child):not(:last-child),.input-group .form-control:not(:first-child):not(:last-child){border-radius:0}.input-group-addon{white-space:nowrap}.input-group-addon,.input-group-btn{width:1%;vertical-align:middle}.input-group-addon{padding:6px 12px;font-size:14px;font-weight:400;line-height:1;color:#555;text-align:center;background-color:#eee;border:1px solid #ccc;border-radius:4px}.input-group-addon.input-sm,.form-horizontal .form-group-sm .input-group-addon.form-control,.input-group-sm>.input-group-addon,.input-group-sm>.input-group-btn>.input-group-addon.btn{padding:5px 10px;font-size:12px;border-radius:3px}.input-group-addon.input-lg,.form-horizontal .form-group-lg .input-group-addon.form-control,.input-group-lg>.input-group-addon,.input-group-lg>.input-group-btn>.input-group-addon.btn{padding:10px 16px;font-size:18px;border-radius:6px}.input-group-addon input[type="radio"],.input-group-addon input[type="checkbox"]{margin-top:0}.input-group .form-control:first-child,.input-group-addon:first-child,.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group>.btn,.input-group-btn:first-child>.dropdown-toggle,.input-group-btn:last-child>.btn:not(:last-child):not(.dropdown-toggle),.input-group-btn:last-child>.btn-group:not(:last-child)>.btn{border-bottom-right-radius:0;border-top-right-radius:0}.input-group-addon:first-child{border-right:0}.input-group .form-control:last-child,.input-group-addon:last-child,.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group>.btn,.input-group-btn:last-child>.dropdown-toggle,.input-group-btn:first-child>.btn:not(:first-child),.input-group-btn:first-child>.btn-group:not(:first-child)>.btn{border-bottom-left-radius:0;border-top-left-radius:0}.input-group-addon:last-child{border-left:0}.input-group-btn{font-size:0;white-space:nowrap}.input-group-btn,.input-group-btn>.btn{position:relative}.input-group-btn>.btn+.btn{margin-left:-1px}.input-group-btn>.btn:hover,.input-group-btn>.btn:focus,.input-group-btn>.btn:active{z-index:2}.input-group-btn:first-child>.btn,.input-group-btn:first-child>.btn-group{margin-right:-1px}.input-group-btn:last-child>.btn,.input-group-btn:last-child>.btn-group{margin-left:-1px}.pagination{display:inline-block;padding-left:0;margin:20px 0;border-radius:4px}.pagination>li{display:inline}.pagination>li>a,.pagination>li>span{position:relative;float:left;padding:6px 12px;line-height:1.4285714;text-decoration:none;color:#428bca;background-color:#fff;border:1px solid #ddd;margin-left:-1px}.pagination>li:first-child>a,.pagination>li:first-child>span{margin-left:0;border-bottom-left-radius:4px;border-top-left-radius:4px}.pagination>li:last-child>a,.pagination>li:last-child>span{border-bottom-right-radius:4px;border-top-right-radius:4px}.pagination>li>a:hover,.pagination>li>a:focus,.pagination>li>span:hover,.pagination>li>span:focus{color:#2a6496;background-color:#eee;border-color:#ddd}.pagination>.active>a,.pagination>.active>a:hover,.pagination>.active>a:focus,.pagination>.active>span,.pagination>.active>span:hover,.pagination>.active>span:focus{z-index:2;color:#fff;background-color:#428bca;border-color:#428bca;cursor:default}.pagination>.disabled>span,.pagination>.disabled>span:hover,.pagination>.disabled>span:focus,.pagination>.disabled>a,.pagination>.disabled>a:hover,.pagination>.disabled>a:focus{color:#777;background-color:#fff;border-color:#ddd;cursor:not-allowed}.pagination-lg>li>a,.pagination-lg>li>span{padding:10px 16px;font-size:18px}.pagination-lg>li:first-child>a,.pagination-lg>li:first-child>span{border-bottom-left-radius:6px;border-top-left-radius:6px}.pagination-lg>li:last-child>a,.pagination-lg>li:last-child>span{border-bottom-right-radius:6px;border-top-right-radius:6px}.pagination-sm>li>a,.pagination-sm>li>span{padding:5px 10px;font-size:12px}.pagination-sm>li:first-child>a,.pagination-sm>li:first-child>span{border-bottom-left-radius:3px;border-top-left-radius:3px}.pagination-sm>li:last-child>a,.pagination-sm>li:last-child>span{border-bottom-right-radius:3px;border-top-right-radius:3px}.close{float:right;font-size:21px;font-weight:700;line-height:1;color:#000;text-shadow:0 1px 0 #fff;opacity:.2;filter:alpha(opacity=20)}.close:hover,.close:focus{color:#000;text-decoration:none;cursor:pointer;opacity:.5;filter:alpha(opacity=50)}button.close{padding:0;cursor:pointer;background:0 0;border:0;-webkit-appearance:none}.modal-open,.modal{overflow:hidden}.modal{display:none;position:fixed;top:0;right:0;bottom:0;left:0;z-index:1050;-webkit-overflow-scrolling:touch;outline:0}.modal.fade .modal-dialog{transform:translate3d(0,-25%,0);transition:transform .3s ease-out}.modal.in .modal-dialog{transform:translate3d(0,0,0)}.modal-open .modal{overflow-x:hidden;overflow-y:auto}.modal-dialog{position:relative;width:auto;margin:10px}.modal-content{position:relative;background-color:#fff;border:1px solid #999;border:1px solid rgba(0,0,0,.2);border-radius:6px;box-shadow:0 3px 9px rgba(0,0,0,.5);background-clip:padding-box;outline:0}.modal-backdrop{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1040;background-color:#000}.modal-backdrop.fade{opacity:0;filter:alpha(opacity=0)}.modal-backdrop.in{opacity:.5;filter:alpha(opacity=50)}.modal-header{padding:15px;border-bottom:1px solid #e5e5e5;min-height:16.4285714px}.modal-header .close{margin-top:-2px}.modal-title{margin:0;line-height:1.4285714}.modal-body{position:relative;padding:15px}.modal-footer{padding:15px;text-align:right;border-top:1px solid #e5e5e5}.modal-footer:before,.modal-footer:after{content:" ";display:table}.modal-footer:after{clear:both}.modal-footer .btn+.btn{margin-left:5px;margin-bottom:0}.modal-footer .btn-group .btn+.btn{margin-left:-1px}.modal-footer .btn-block+.btn-block{margin-left:0}.modal-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.clearfix:before,.clearfix:after{content:" ";display:table}.clearfix:after{clear:both}.center-block{display:block;margin-left:auto;margin-right:auto}.pull-right{float:right!important}.pull-left{float:left!important}.hide{display:none!important}.show{display:block!important}.invisible{visibility:hidden}.text-hide{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0}.hidden{display:none!important;visibility:hidden!important}.affix{position:fixed;transform:translate3d(0,0,0)}.hljs{display:block;overflow-x:auto;padding:.5em;background:#002b36;color:#839496;-webkit-text-size-adjust:none}.hljs-comment,.hljs-template_comment,.diff .hljs-header,.hljs-doctype,.hljs-pi,.lisp .hljs-string,.hljs-javadoc{color:#586e75}.hljs-keyword,.hljs-winutils,.method,.hljs-addition,.css .hljs-tag,.hljs-request,.hljs-status,.nginx .hljs-title{color:#859900}.hljs-number,.hljs-command,.hljs-string,.hljs-tag .hljs-value,.hljs-rules .hljs-value,.hljs-phpdoc,.hljs-dartdoc,.tex .hljs-formula,.hljs-regexp,.hljs-hexcolor,.hljs-link_url{color:#2aa198}.hljs-title,.hljs-localvars,.hljs-chunk,.hljs-decorator,.hljs-built_in,.hljs-identifier,.vhdl .hljs-literal,.hljs-id,.css .hljs-function{color:#268bd2}.hljs-attribute,.hljs-variable,.lisp .hljs-body,.smalltalk .hljs-number,.hljs-constant,.hljs-class .hljs-title,.hljs-parent,.hljs-type,.hljs-link_reference{color:#b58900}.hljs-preprocessor,.hljs-preprocessor .hljs-keyword,.hljs-pragma,.hljs-shebang,.hljs-symbol,.hljs-symbol .hljs-string,.diff .hljs-change,.hljs-special,.hljs-attr_selector,.hljs-subst,.hljs-cdata,.css .hljs-pseudo,.hljs-header{color:#cb4b16}.hljs-deletion,.hljs-important{color:#dc322f}.hljs-link_label{color:#6c71c4}.tex .hljs-formula{background:#073642}*,*:before,*:after{box-sizing:border-box}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background:0 0}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:700}dfn{font-style:italic}h1{margin:.67em 0}mark{background:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-.5em}sub{bottom:-.25em}images{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{box-sizing:content-box;height:0}pre{overflow:auto}code,kbd{font-size:1em}code,kbd,pre,samp{font-family:monospace,monospace}samp{font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],html input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0;margin-right:5px}input[type="number"]::-webkit-inner-spin-button,input[type="number"]::-webkit-outer-spin-button{height:auto}input[type="search"]{-webkit-appearance:textfield;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:700}table{border-collapse:collapse;border-spacing:0}.debug{background-color:#ffc0cb!important}.ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ir{background-color:transparent;border:0;overflow:hidden}.ir::before{content:'';display:block;height:150%;width:0}html{font-size:.875em;background:#fff;color:#373D49}html,body{font-family:Georgia,Cambria,serif;height:100%}body{font-size:1rem;font-weight:400;line-height:2rem}ul,ol{margin-bottom:.83999rem;padding-top:.16001rem}li{font-feature-settings:'kern' 1,'onum' 1,'liga' 1;margin-left:1rem}li>ul,li>ol{margin-bottom:0}p{padding-top:.66001rem;font-feature-settings:'kern' 1,'onum' 1,'liga' 1;margin-top:0}p,pre{margin-bottom:1.33999rem}pre{font-size:1rem;padding:.66001rem 9.5px 9.5px;line-height:2rem;background:linear-gradient(to bottom,#fff 0,#fff .75rem,#f5f7fa .75rem,#f5f7fa 2.75rem,#fff 2.75rem,#fff 4rem);background-size:100% 4rem;border-color:#D3DAEA}blockquote{margin:0}blockquote p{font-size:1rem;margin-bottom:.33999rem;font-style:italic;padding:.66001rem 1rem 1rem;border-left:3px solid #A0AABF}th,td{padding:12px}h1,h2,h3,h4,h5,h6{font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-feature-settings:'dlig' 1,'liga' 1,'lnum' 1,'kern' 1;font-style:normal;font-weight:600;margin-top:0}h1{line-height:3rem;font-size:2.0571429rem;margin-bottom:.21999rem;padding-top:.78001rem}h2{font-size:1.953125rem;margin-bottom:.1835837rem;padding-top:.8164163rem}h2,h3{line-height:3rem}h3{font-size:1.6457143rem;margin-bottom:.07599rem;padding-top:.92401rem}h4{font-size:1.5625rem;margin-bottom:.546865rem;padding-top:.453135rem}h5{font-size:1.25rem;margin-bottom:-.56251rem;padding-top:.56251rem}h6{font-size:1rem;margin-bottom:-.65001rem;padding-top:.65001rem}a{cursor:pointer;color:#35D7BB;text-decoration:none}a:hover,a:focus{border-bottom-color:#35D7BB;color:#dff9f4}img{height:auto;max-width:100%}dt{font-style:italic;font-weight:600}.g{display:block}.g:after{clear:both;content:'';display:table}.g-b{float:left;margin:0;width:100%}.g{margin-left:-16px;margin-right:-16px}.g-b{padding-left:16px;padding-right:16px}.g-b--center{display:block;float:none;margin:0 auto}.g-b--right{float:right}.g-b--1of1{width:100%}.g-b--1of2,.g-b--2of4,.g-b--3of6,.g-b--4of8,.g-b--5of10,.g-b--6of12{width:50%}.g-b--1of3,.g-b--2of6,.g-b--4of12{width:33.333%}.g-b--2of3,.g-b--4of6,.g-b--8of12{width:66.666%}.g-b--1of4,.g-b--2of8,.g-b--3of12{width:25%}.g-b--3of4,.g-b--6of8,.g-b--9of12{width:75%}.g-b--1of5,.g-b--2of10{width:20%}.g-b--2of5,.g-b--4of10{width:40%}.g-b--3of5,.g-b--6of10{width:60%}.g-b--4of5,.g-b--8of10{width:80%}.g-b--1of6,.g-b--2of12{width:16.666%}.g-b--5of6,.g-b--10of12{width:83.333%}.g-b--1of8{width:12.5%}.g-b--3of8{width:37.5%}.g-b--5of8{width:62.5%}.g-b--7of8{width:87.5%}.g-b--1of10{width:10%}.g-b--3of10{width:30%}.g-b--7of10{width:70%}.g-b--9of10{width:90%}.g-b--1of12{width:8.333%}.g-b--5of12{width:41.666%}.g-b--7of12{width:58.333%}.g-b--11of12{width:91.666%}.g-b--push--1of1{margin-left:100%}.g-b--push--1of2,.g-b--push--2of4,.g-b--push--3of6,.g-b--push--4of8,.g-b--push--5of10,.g-b--push--6of12{margin-left:50%}.g-b--push--1of3,.g-b--push--2of6,.g-b--push--4of12{margin-left:33.333%}.g-b--push--2of3,.g-b--push--4of6,.g-b--push--8of12{margin-left:66.666%}.g-b--push--1of4,.g-b--push--2of8,.g-b--push--3of12{margin-left:25%}.g-b--push--3of4,.g-b--push--6of8,.g-b--push--9of12{margin-left:75%}.g-b--push--1of5,.g-b--push--2of10{margin-left:20%}.g-b--push--2of5,.g-b--push--4of10{margin-left:40%}.g-b--push--3of5,.g-b--push--6of10{margin-left:60%}.g-b--push--4of5,.g-b--push--8of10{margin-left:80%}.g-b--push--1of6,.g-b--push--2of12{margin-left:16.666%}.g-b--push--5of6,.g-b--push--10of12{margin-left:83.333%}.g-b--push--1of8{margin-left:12.5%}.g-b--push--3of8{margin-left:37.5%}.g-b--push--5of8{margin-left:62.5%}.g-b--push--7of8{margin-left:87.5%}.g-b--push--1of10{margin-left:10%}.g-b--push--3of10{margin-left:30%}.g-b--push--7of10{margin-left:70%}.g-b--push--9of10{margin-left:90%}.g-b--push--1of12{margin-left:8.333%}.g-b--push--5of12{margin-left:41.666%}.g-b--push--7of12{margin-left:58.333%}.g-b--push--11of12{margin-left:91.666%}.g-b--pull--1of1{margin-right:100%}.g-b--pull--1of2,.g-b--pull--2of4,.g-b--pull--3of6,.g-b--pull--4of8,.g-b--pull--5of10,.g-b--pull--6of12{margin-right:50%}.g-b--pull--1of3,.g-b--pull--2of6,.g-b--pull--4of12{margin-right:33.333%}.g-b--pull--2of3,.g-b--pull--4of6,.g-b--pull--8of12{margin-right:66.666%}.g-b--pull--1of4,.g-b--pull--2of8,.g-b--pull--3of12{margin-right:25%}.g-b--pull--3of4,.g-b--pull--6of8,.g-b--pull--9of12{margin-right:75%}.g-b--pull--1of5,.g-b--pull--2of10{margin-right:20%}.g-b--pull--2of5,.g-b--pull--4of10{margin-right:40%}.g-b--pull--3of5,.g-b--pull--6of10{margin-right:60%}.g-b--pull--4of5,.g-b--pull--8of10{margin-right:80%}.g-b--pull--1of6,.g-b--pull--2of12{margin-right:16.666%}.g-b--pull--5of6,.g-b--pull--10of12{margin-right:83.333%}.g-b--pull--1of8{margin-right:12.5%}.g-b--pull--3of8{margin-right:37.5%}.g-b--pull--5of8{margin-right:62.5%}.g-b--pull--7of8{margin-right:87.5%}.g-b--pull--1of10{margin-right:10%}.g-b--pull--3of10{margin-right:30%}.g-b--pull--7of10{margin-right:70%}.g-b--pull--9of10{margin-right:90%}.g-b--pull--1of12{margin-right:8.333%}.g-b--pull--5of12{margin-right:41.666%}.g-b--pull--7of12{margin-right:58.333%}.g-b--pull--11of12{margin-right:91.666%}.splashscreen{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#373D49;z-index:22}.splashscreen-dillinger{width:260px;height:auto;display:block;margin:0 auto;padding-bottom:3rem}.splashscreen p{font-size:1.25rem;padding-top:.56251rem;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;text-align:center;max-width:500px;margin:0 auto;color:#FFF}.sp-center{position:relative;transform:translateY(-50%);top:50%}.open-menu>.wrapper{overflow-x:hidden}.page{margin:0 auto;position:relative;top:0;left:0;width:100%;height:100%;z-index:2;transition:all .25s ease-in-out;background-color:#fff;padding-top:51px;will-change:left}.open-menu .page{left:270px}.title{line-height:1rem;font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem;font-weight:500;color:#A0AABF;letter-spacing:1px;text-transform:uppercase;padding-left:16px;padding-right:16px;margin-top:1rem}.split-preview .title{padding-left:0}.title-document{line-height:1rem;font-size:1.25rem;margin-bottom:.89999rem;padding-top:.10001rem;font-weight:400;font-family:"Ubuntu Mono",Monaco;color:#373D49;padding-left:16px;padding-right:16px;width:80%;min-width:300px;outline:0;border:none}.icon{display:block;margin:0 auto;width:36px;height:36px;border-radius:3px;text-align:center}.icon svg{display:inline-block;margin-left:auto;margin-right:auto}.icon-preview{background-color:#373D49;line-height:40px}.icon-preview svg{width:19px;height:12px}.icon-settings{background-color:#373D49;line-height:44px}.icon-settings svg{width:18px;height:18px}.icon-link{width:16px;height:16px;line-height:1;margin-right:24px;text-align:right}.navbar{background-color:#373D49;height:51px;width:100%;position:fixed;top:0;left:0;z-index:6;transition:all .25s ease-in-out;will-change:left}.navbar:after{content:"";display:table;clear:both}.open-menu .navbar{left:270px}.navbar-brand{float:left;margin:0 0 0 24px;padding:0;line-height:42px}.navbar-brand svg{width:85px;height:11px}.nav-left{float:left}.nav-right{float:right}.nav-sidebar{width:100%}.menu{list-style:none;margin:0;padding:0}.menu a{border:0;color:#A0AABF;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;outline:none;text-transform:uppercase}.menu a:hover{color:#35D7BB}.menu .menu-item{border:0;display:none;float:left;margin:0;position:relative}.menu .menu-item>a{display:block;font-size:12px;height:51px;letter-spacing:1px;line-height:51px;padding:0 24px}.menu .menu-item--settings,.menu .menu-item--preview,.menu .menu-item--save-to.in-sidebar,.menu .menu-item--import-from.in-sidebar,.menu .menu-item--link-unlink.in-sidebar,.menu .menu-item--documents.in-sidebar{display:block}.menu .menu-item--documents{padding-bottom:1rem}.menu .menu-item.open>a{background-color:#1D212A}.menu .menu-item-icon>a{height:auto;padding:0}.menu .menu-item-icon:hover>a{background-color:transparent}.menu .menu-link.open i{background-color:#1D212A}.menu .menu-link.open g{fill:#35D7BB}.menu .menu-link-preview,.menu .menu-link-settings{margin-top:8px;width:51px}.menu-sidebar{width:100%}.menu-sidebar .menu-item{float:none;margin-bottom:1px;width:100%}.menu-sidebar .menu-item.open>a{background-color:#373D49}.menu-sidebar .open .caret{transform:rotate(180deg)}.menu-sidebar>.menu-item:hover .dropdown a,.menu-sidebar>.menu-item:hover .settings a{background-color:transparent}.menu-sidebar .menu-link{background-color:#373D49;font-weight:600}.menu-sidebar .menu-link:after{content:"";display:table;clear:both}.menu-sidebar .menu-link>span{float:left}.menu-sidebar .menu-link>.caret{float:right;text-align:right;top:22px}.menu-sidebar .dropdown,.menu-sidebar .settings{background-color:transparent;position:static;width:100%}.dropdown{position:absolute;right:0;top:51px;width:188px}.dropdown,.settings{display:none;background-color:#1D212A}.dropdown{padding:0}.dropdown,.settings,.sidebar-list{list-style:none;margin:0}.sidebar-list{padding:0}.dropdown li{margin:32px 0;padding:0 0 0 32px}.dropdown li,.settings li{line-height:1}.sidebar-list li{line-height:1;margin:32px 0;padding:0 0 0 32px}.dropdown a{color:#D0D6E2}.dropdown a,.settings a,.sidebar-list a{display:block;text-transform:none}.sidebar-list a{color:#D0D6E2}.dropdown a:after,.settings a:after,.sidebar-list a:after{content:"";display:table;clear:both}.dropdown .icon,.settings .icon,.sidebar-list .icon{float:right}.open .dropdown,.open .settings,.open .sidebar-list{display:block}.open .dropdown.collapse,.open .collapse.settings,.open .sidebar-list.collapse{display:none}.open .dropdown.collapse.in,.open .collapse.in.settings,.open .sidebar-list.collapse.in{display:block}.dropdown .unlinked .icon,.settings .unlinked .icon,.sidebar-list .unlinked .icon{opacity:.3}.dropdown.documents li,.documents.settings li,.sidebar-list.documents li{background-image:url("../img/icons/file.svg");background-position:240px center;background-repeat:no-repeat;background-size:14px 16px;padding:3px 32px}.dropdown.documents li.octocat,.documents.settings li.octocat,.sidebar-list.documents li.octocat{background-image:url("../img/icons/octocat.svg");background-position:234px center;background-size:24px 24px}.dropdown.documents li:last-child,.documents.settings li:last-child,.sidebar-list.documents li:last-child{margin-bottom:1rem}.dropdown.documents li.active a,.documents.settings li.active a,.sidebar-list.documents li.active a{color:#35D7BB}.settings{position:fixed;top:67px;right:16px;border-radius:3px;width:288px;background-color:#373D49;padding:16px;z-index:7}.show-settings .settings{display:block}.settings .has-checkbox{float:left}.settings form{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.settings input{width:20%}.settings a{font-size:1.25rem;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;-webkit-font-smoothing:antialiased;line-height:28px;color:#D0D6E2}.settings a:after{content:"";display:table;clear:both}.settings a:hover{color:#35D7BB}.settings li{border-bottom:1px solid #4F535B;margin:0;padding:16px 0}.settings li:last-child{border-bottom:none}.brand{border:none;display:block}.brand:hover g{fill:#35D7BB}.toggle{display:block;float:left;height:16px;padding:25px 16px 26px;width:40px}.toggle span:after,.toggle span:before{content:'';left:0;position:absolute;top:-6px}.toggle span:after{top:6px}.toggle span{display:block;position:relative}.toggle span,.toggle span:after,.toggle span:before{-webkit-backface-visibility:hidden;backface-visibility:hidden;background-color:#D3DAEA;height:2px;transition:all .3s;width:20px}.open-menu .toggle span{background-color:transparent}.open-menu .toggle span:before{transform:rotate(45deg) translate(3px,3px)}.open-menu .toggle span:after{transform:rotate(-45deg) translate(5px,-6px)}.caret{display:inline-block;width:0;height:0;margin-left:6px;vertical-align:middle;position:relative;top:-1px;border-top:4px solid;border-right:4px solid transparent;border-left:4px solid transparent}.sidebar{overflow:auto;height:100%;padding-right:15px;padding-bottom:15px;width:285px}.sidebar-wrapper{-webkit-overflow-scrolling:touch;background-color:#2B2F36;left:0;height:100%;overflow-y:hidden;position:fixed;top:0;width:285px;z-index:1}.sidebar-branding{width:160px;padding:0;margin:16px auto}.header{border-bottom:1px solid #E8E8E8;position:relative}.words,.characters{line-height:1rem;font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem;font-weight:500;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;letter-spacing:1px;text-transform:uppercase;z-index:5;position:absolute;right:16px;top:0}.words span,.characters span{color:#A0AABF}.words .counter,.characters .counter{color:#000}.words+.characters{top:22px}.mr10{margin-right:10px}.btn{text-align:center;display:inline-block;width:100%;text-transform:uppercase;font-weight:600;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:14px;text-shadow:0 1px 0 #1b8b77;padding:16px 24px;background-color:#35D7BB;border-radius:3px;margin:0 auto 16px;line-height:1;color:#fff;transition:all .15s linear;-webkit-font-smoothing:antialiased}.btn--new,.btn--save{display:block;width:238px}.btn--new:hover,.btn--new:focus,.btn--save:hover,.btn--save:focus{color:#fff;border-bottom-color:transparent;box-shadow:0 1px 3px #24b59c;text-shadow:0 1px 0 #24b59c}.btn--save{background-color:#4A5261;text-shadow:0 1px 1px #1e2127}.btn--save:hover,.btn--save:focus{color:#fff;border-bottom-color:transparent;box-shadow:0 1px 5px #08090a;text-shadow:none}.btn--delete{display:block;width:238px;background-color:transparent;font-size:12px;text-shadow:none}.btn--delete:hover,.btn--delete:focus{color:#fff;border-bottom-color:transparent;text-shadow:0 1px 0 #08090a;opacity:.8}.btn--delete-modal,.btn--ok,.btn--close{border-top:0;background-color:#4A5261;text-shadow:0 1px 0 #08090a;margin:0}.btn--delete-modal:hover,.btn--delete-modal:focus,.btn--ok:hover,.btn--ok:focus,.btn--close:hover,.btn--close:focus{color:#fff;background-color:#292d36;text-shadow:none}.btn--delete-modal{display:inline;width:auto}.overlay{position:absolute;top:0;left:0;width:100%;height:100%;background-color:rgba(55,61,73,.8);transition:all .25s ease-in-out;transition-timing-function:ease-out;will-change:left,opacity,visibility;z-index:5;opacity:0;visibility:hidden}.show-settings .overlay{visibility:visible;opacity:1}.switch{float:right;line-height:1}.switch input{display:none}.switch small{display:inline-block;cursor:pointer;padding:0 24px 0 0;transition:all ease .2s;background-color:#2B2F36;border-color:#2B2F36}.switch small,.switch small:before{border-radius:30px;box-shadow:inset 0 0 2px 0 #14171F}.switch small:before{display:block;content:'';width:28px;height:28px;background:#fff}.switch.checked small{padding-right:0;padding-left:24px;background-color:#35D7BB;box-shadow:none}.modal--dillinger.about .modal-dialog{font-size:1.25rem;max-width:500px}.modal--dillinger.scope .modal-dialog{max-width:300px;margin:5rem auto}.modal--dillinger .modal-dialog{max-width:600px;width:auto;margin:5rem auto}.modal--dillinger .modal-content{background:#373D49;border-radius:3px;box-shadow:0 2px 5px 0 #2C3B59;color:#fff;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;padding:2rem}.modal--dillinger ul{list-style-type:disc;margin:1rem 0;padding:0 0 0 1rem}.modal--dillinger li{padding:0;margin:0}.modal--dillinger .modal-header{border:0;padding:0}.modal--dillinger .modal-body{padding:0}.modal--dillinger .modal-footer{border:0;padding:0}.modal--dillinger .close{color:#fff;opacity:1}.modal-backdrop{background-color:#373D49}.pagination--dillinger{padding:0!important;margin:1.5rem 0!important;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:row;flex-direction:row;-ms-flex-align:center;align-items:center;-ms-flex-line-pack:stretch;align-content:stretch}.pagination--dillinger li{display:-ms-flexbox;display:flex;-ms-flex-positive:1;flex-grow:1;text-align:center}.pagination--dillinger li:first-child>a,.pagination--dillinger li.disabled>a,.pagination--dillinger li.disabled>a:hover,.pagination--dillinger li.disabled>a:focus,.pagination--dillinger li>a{background-color:transparent;border-color:#4F535B;border-right-color:transparent}.pagination--dillinger li.active>a,.pagination--dillinger li.active>a:hover,.pagination--dillinger li.active>a:focus{border-color:#4A5261;background-color:#4A5261;color:#fff}.pagination--dillinger li>a{float:none;color:#fff;width:100%;display:block;text-align:center;margin:0;border-right-color:transparent;padding:6px}.pagination--dillinger li>a:hover,.pagination--dillinger li>a:focus{border-color:#35D7BB;background-color:#35D7BB;color:#fff}.pagination--dillinger li:last-child a{border-color:#4F535B}.pagination--dillinger li:first-child a{border-right-color:transparent}.diNotify{position:absolute;z-index:9999;left:0;right:0;top:0;margin:0 auto;max-width:400px;text-align:center;transition:top .5s ease-in-out,opacity .5s ease-in-out;visibility:hidden}.diNotify-body{-webkit-font-smoothing:antialiased;background-color:#35D7BB;background:#666E7F;border-radius:3px;color:#fff;font-family:"Source Sans Pro","Helvetica Neue",Helvetica,Arial,sans-serif;font-weight:400;overflow:hidden;padding:1rem 2rem .5rem;display:-ms-flexbox;display:flex;-ms-flex-align:baseline;align-items:baseline;-ms-flex-pack:center;justify-content:center}.diNotify-icon{display:block;width:16px;height:16px;line-height:16px;position:relative;top:3px}.diNotify-message{padding-left:1rem}.zen-wrapper{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;height:100%;z-index:10;background-color:#FFF;opacity:0;transition:opacity .25s ease-in-out}.zen-wrapper.on{opacity:1}.enter-zen-mode{background-image:url("../img/icons/enter-zen.svg");right:.5rem;top:.313rem;display:none}.enter-zen-mode,.close-zen-mode{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0;background-repeat:no-repeat;width:32px;height:32px;display:block;position:absolute}.close-zen-mode{background-image:url("../img/icons/exit-zen.svg");right:1rem;top:1rem}.zen-page{position:relative;top:0;bottom:0;z-index:11;height:100%;width:100%}#zen{font-size:1.25rem;width:300px;height:80%;margin:0 auto;position:relative;top:10%}#zen:before,#zen:after{content:"";position:absolute;height:10%;width:100%;z-index:12;pointer-events:none}#preview .table{width:auto}.ui-resizable{position:relative}.ui-resizable-handle{position:absolute;font-size:.1px;z-index:99999;display:block}.ui-resizable-e{background-color:#666;border-right:8px solid #e8e8e8;border-left:1px solid #222;width:10px;z-index:88!important;position:relative}.ui-resizable-e:after{content:"-";display:block;position:absolute;top:calc(50% - 16px);left:0;height:25px;width:2px;background-color:rgba(0,0,0,.4);margin:3px}#editor{cursor:ew-resize;position:relative;z-index:auto}.profile-pic{float:left;width:250px}#_default_ a::before{color:#A0AABF}#_default_ img{display:none}#_default_ #_default_{display:block;float:left;max-width:38%;word-wrap:break-word}#_default_ .default-ad{display:none}#_default_ ._default_{display:block}#_default_ a{color:#35d7bb;text-decoration:none}#_default_ a:hover{color:#8ae8d8}#_default_ .default-image{display:none}#_default_ .default-title:after{content:""}#_default_ .default-title,#_default_ .default-text,#_default_ .default-description{display:inline}#_default_ .default-title{position:relative;font-weight:600;display:none}#_default_ a:before{position:relative;top:0;padding:5px;color:#a0aabf;content:"Ad";text-transform:uppercase;font-size:8px;font-family:Verdana,sans-serif}#_default_{display:block;float:left;max-width:38%;word-wrap:break-word}#_default_ ._default_{display:block;font-size:.75rem;height:51px;letter-spacing:1px;line-height:1rem;padding:18px 24px}body{max-width:1024px;margin:0 auto;overflow:auto;padding:2%}.split{overflow:scroll;padding:0!important;-webkit-overflow-scrolling:touch}.split-editor{padding-left:0;padding-right:0;position:relative;z-index:3}.show-preview .split-editor{display:none}.split-preview{background-color:#fff;display:none;top:0;position:relative;z-index:4}.show-preview .split-preview{display:block}#editor{font-size:1rem;font-family:"Ubuntu Mono",Monaco;font-weight:400;line-height:2rem;width:100%;height:100%}#editor .ace_gutter{-webkit-font-smoothing:antialiased}.editor-header{width:50%;float:left;border-bottom:1px solid #E8E8E8;position:relative}.editor-header--first{border-right:1px solid #E8E8E8}.editor-header .title{display:inline-block}.preview-html{padding:15px}.preview-html a{color:#A0AABF;text-decoration:underline}.preview-src{white-space:normal}.preview-mode-toggle-src{background-image:url("../img/icons/code.svg")}.preview-mode-toggle-src,.preview-mode-toggle-html{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;border:0;background-repeat:no-repeat;width:32px;height:32px;display:block;position:absolute;right:.5rem;top:.5rem;display:none}.preview-mode-toggle-html{background-image:url("../img/icons/eye.svg")}.sr-only{visibility:hidden;text-overflow:110%;overflow:hidden;top:-100px;position:absolute}.mnone{margin:0!important}@media screen and (min-width:27.5em){html{font-size:.875em}body{font-size:1rem}ul,ol{margin-bottom:.83999rem;padding-top:.16001rem}p{padding-top:.66001rem}p,pre{margin-bottom:1.33999rem}pre,blockquote p{font-size:1rem;padding-top:.66001rem}blockquote p{margin-bottom:.33999rem}h1{font-size:2.0571429rem;margin-bottom:.21999rem;padding-top:.78001rem}h2{font-size:1.953125rem;margin-bottom:.1835837rem;padding-top:.8164163rem}h3{font-size:1.6457143rem;margin-bottom:.07599rem;padding-top:.92401rem}h4{font-size:1.5625rem;margin-bottom:.546865rem;padding-top:.453135rem}h5{font-size:1.25rem;margin-bottom:-.56251rem;padding-top:.56251rem}h6{font-size:1rem;margin-bottom:-.65001rem;padding-top:.65001rem}.g{margin-left:-16px;margin-right:-16px}.g-b{padding-left:16px;padding-right:16px}.g-b--m1of1{width:100%}.g-b--m1of2,.g-b--m2of4,.g-b--m3of6,.g-b--m4of8,.g-b--m5of10,.g-b--m6of12{width:50%}.g-b--m1of3,.g-b--m2of6,.g-b--m4of12{width:33.333%}.g-b--m2of3,.g-b--m4of6,.g-b--m8of12{width:66.666%}.g-b--m1of4,.g-b--m2of8,.g-b--m3of12{width:25%}.g-b--m3of4,.g-b--m6of8,.g-b--m9of12{width:75%}.g-b--m1of5,.g-b--m2of10{width:20%}.g-b--m2of5,.g-b--m4of10{width:40%}.g-b--m3of5,.g-b--m6of10{width:60%}.g-b--m4of5,.g-b--m8of10{width:80%}.g-b--m1of6,.g-b--m2of12{width:16.666%}.g-b--m5of6,.g-b--m10of12{width:83.333%}.g-b--m1of8{width:12.5%}.g-b--m3of8{width:37.5%}.g-b--m5of8{width:62.5%}.g-b--m7of8{width:87.5%}.g-b--m1of10{width:10%}.g-b--m3of10{width:30%}.g-b--m7of10{width:70%}.g-b--m9of10{width:90%}.g-b--m1of12{width:8.333%}.g-b--m5of12{width:41.666%}.g-b--m7of12{width:58.333%}.g-b--m11of12{width:91.666%}.g-b--push--m1of1{margin-left:100%}.g-b--push--m1of2,.g-b--push--m2of4,.g-b--push--m3of6,.g-b--push--m4of8,.g-b--push--m5of10,.g-b--push--m6of12{margin-left:50%}.g-b--push--m1of3,.g-b--push--m2of6,.g-b--push--m4of12{margin-left:33.333%}.g-b--push--m2of3,.g-b--push--m4of6,.g-b--push--m8of12{margin-left:66.666%}.g-b--push--m1of4,.g-b--push--m2of8,.g-b--push--m3of12{margin-left:25%}.g-b--push--m3of4,.g-b--push--m6of8,.g-b--push--m9of12{margin-left:75%}.g-b--push--m1of5,.g-b--push--m2of10{margin-left:20%}.g-b--push--m2of5,.g-b--push--m4of10{margin-left:40%}.g-b--push--m3of5,.g-b--push--m6of10{margin-left:60%}.g-b--push--m4of5,.g-b--push--m8of10{margin-left:80%}.g-b--push--m1of6,.g-b--push--m2of12{margin-left:16.666%}.g-b--push--m5of6,.g-b--push--m10of12{margin-left:83.333%}.g-b--push--m1of8{margin-left:12.5%}.g-b--push--m3of8{margin-left:37.5%}.g-b--push--m5of8{margin-left:62.5%}.g-b--push--m7of8{margin-left:87.5%}.g-b--push--m1of10{margin-left:10%}.g-b--push--m3of10{margin-left:30%}.g-b--push--m7of10{margin-left:70%}.g-b--push--m9of10{margin-left:90%}.g-b--push--m1of12{margin-left:8.333%}.g-b--push--m5of12{margin-left:41.666%}.g-b--push--m7of12{margin-left:58.333%}.g-b--push--m11of12{margin-left:91.666%}.g-b--pull--m1of1{margin-right:100%}.g-b--pull--m1of2,.g-b--pull--m2of4,.g-b--pull--m3of6,.g-b--pull--m4of8,.g-b--pull--m5of10,.g-b--pull--m6of12{margin-right:50%}.g-b--pull--m1of3,.g-b--pull--m2of6,.g-b--pull--m4of12{margin-right:33.333%}.g-b--pull--m2of3,.g-b--pull--m4of6,.g-b--pull--m8of12{margin-right:66.666%}.g-b--pull--m1of4,.g-b--pull--m2of8,.g-b--pull--m3of12{margin-right:25%}.g-b--pull--m3of4,.g-b--pull--m6of8,.g-b--pull--m9of12{margin-right:75%}.g-b--pull--m1of5,.g-b--pull--m2of10{margin-right:20%}.g-b--pull--m2of5,.g-b--pull--m4of10{margin-right:40%}.g-b--pull--m3of5,.g-b--pull--m6of10{margin-right:60%}.g-b--pull--m4of5,.g-b--pull--m8of10{margin-right:80%}.g-b--pull--m1of6,.g-b--pull--m2of12{margin-right:16.666%}.g-b--pull--m5of6,.g-b--pull--m10of12{margin-right:83.333%}.g-b--pull--m1of8{margin-right:12.5%}.g-b--pull--m3of8{margin-right:37.5%}.g-b--pull--m5of8{margin-right:62.5%}.g-b--pull--m7of8{margin-right:87.5%}.g-b--pull--m1of10{margin-right:10%}.g-b--pull--m3of10{margin-right:30%}.g-b--pull--m7of10{margin-right:70%}.g-b--pull--m9of10{margin-right:90%}.g-b--pull--m1of12{margin-right:8.333%}.g-b--pull--m5of12{margin-right:41.666%}.g-b--pull--m7of12{margin-right:58.333%}.g-b--pull--m11of12{margin-right:91.666%}.splashscreen p{font-size:1.25rem;margin-bottom:1.43749rem;padding-top:.56251rem}.title{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.title-document{margin-bottom:.89999rem;padding-top:.10001rem}.title-document,.settings a{font-size:1.25rem}.words,.characters{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.modal--dillinger.about .modal-dialog,#zen{font-size:1.25rem}#zen{width:400px}#editor{font-size:1rem}}@media screen and (min-width:46.25em){html{font-size:.875em}body{font-size:1rem}ul,ol{margin-bottom:.83999rem;padding-top:.16001rem}p{padding-top:.66001rem}p,pre{margin-bottom:1.33999rem}pre,blockquote p{font-size:1rem;padding-top:.66001rem}blockquote p{margin-bottom:.33999rem}h1{font-size:2.0571429rem;margin-bottom:.21999rem;padding-top:.78001rem}h2{font-size:1.953125rem;margin-bottom:.1835837rem;padding-top:.8164163rem}h3{font-size:1.6457143rem;margin-bottom:.07599rem;padding-top:.92401rem}h4{font-size:1.5625rem;margin-bottom:.546865rem;padding-top:.453135rem}h5{font-size:1.25rem;margin-bottom:-.56251rem;padding-top:.56251rem}h6{font-size:1rem;margin-bottom:-.65001rem;padding-top:.65001rem}.g{margin-left:-16px;margin-right:-16px}.g-b{padding-left:16px;padding-right:16px}.g-b--t1of1{width:100%}.g-b--t1of2,.g-b--t2of4,.g-b--t3of6,.g-b--t4of8,.g-b--t5of10,.g-b--t6of12{width:50%}.g-b--t1of3,.g-b--t2of6,.g-b--t4of12{width:33.333%}.g-b--t2of3,.g-b--t4of6,.g-b--t8of12{width:66.666%}.g-b--t1of4,.g-b--t2of8,.g-b--t3of12{width:25%}.g-b--t3of4,.g-b--t6of8,.g-b--t9of12{width:75%}.g-b--t1of5,.g-b--t2of10{width:20%}.g-b--t2of5,.g-b--t4of10{width:40%}.g-b--t3of5,.g-b--t6of10{width:60%}.g-b--t4of5,.g-b--t8of10{width:80%}.g-b--t1of6,.g-b--t2of12{width:16.666%}.g-b--t5of6,.g-b--t10of12{width:83.333%}.g-b--t1of8{width:12.5%}.g-b--t3of8{width:37.5%}.g-b--t5of8{width:62.5%}.g-b--t7of8{width:87.5%}.g-b--t1of10{width:10%}.g-b--t3of10{width:30%}.g-b--t7of10{width:70%}.g-b--t9of10{width:90%}.g-b--t1of12{width:8.333%}.g-b--t5of12{width:41.666%}.g-b--t7of12{width:58.333%}.g-b--t11of12{width:91.666%}.g-b--push--t1of1{margin-left:100%}.g-b--push--t1of2,.g-b--push--t2of4,.g-b--push--t3of6,.g-b--push--t4of8,.g-b--push--t5of10,.g-b--push--t6of12{margin-left:50%}.g-b--push--t1of3,.g-b--push--t2of6,.g-b--push--t4of12{margin-left:33.333%}.g-b--push--t2of3,.g-b--push--t4of6,.g-b--push--t8of12{margin-left:66.666%}.g-b--push--t1of4,.g-b--push--t2of8,.g-b--push--t3of12{margin-left:25%}.g-b--push--t3of4,.g-b--push--t6of8,.g-b--push--t9of12{margin-left:75%}.g-b--push--t1of5,.g-b--push--t2of10{margin-left:20%}.g-b--push--t2of5,.g-b--push--t4of10{margin-left:40%}.g-b--push--t3of5,.g-b--push--t6of10{margin-left:60%}.g-b--push--t4of5,.g-b--push--t8of10{margin-left:80%}.g-b--push--t1of6,.g-b--push--t2of12{margin-left:16.666%}.g-b--push--t5of6,.g-b--push--t10of12{margin-left:83.333%}.g-b--push--t1of8{margin-left:12.5%}.g-b--push--t3of8{margin-left:37.5%}.g-b--push--t5of8{margin-left:62.5%}.g-b--push--t7of8{margin-left:87.5%}.g-b--push--t1of10{margin-left:10%}.g-b--push--t3of10{margin-left:30%}.g-b--push--t7of10{margin-left:70%}.g-b--push--t9of10{margin-left:90%}.g-b--push--t1of12{margin-left:8.333%}.g-b--push--t5of12{margin-left:41.666%}.g-b--push--t7of12{margin-left:58.333%}.g-b--push--t11of12{margin-left:91.666%}.g-b--pull--t1of1{margin-right:100%}.g-b--pull--t1of2,.g-b--pull--t2of4,.g-b--pull--t3of6,.g-b--pull--t4of8,.g-b--pull--t5of10,.g-b--pull--t6of12{margin-right:50%}.g-b--pull--t1of3,.g-b--pull--t2of6,.g-b--pull--t4of12{margin-right:33.333%}.g-b--pull--t2of3,.g-b--pull--t4of6,.g-b--pull--t8of12{margin-right:66.666%}.g-b--pull--t1of4,.g-b--pull--t2of8,.g-b--pull--t3of12{margin-right:25%}.g-b--pull--t3of4,.g-b--pull--t6of8,.g-b--pull--t9of12{margin-right:75%}.g-b--pull--t1of5,.g-b--pull--t2of10{margin-right:20%}.g-b--pull--t2of5,.g-b--pull--t4of10{margin-right:40%}.g-b--pull--t3of5,.g-b--pull--t6of10{margin-right:60%}.g-b--pull--t4of5,.g-b--pull--t8of10{margin-right:80%}.g-b--pull--t1of6,.g-b--pull--t2of12{margin-right:16.666%}.g-b--pull--t5of6,.g-b--pull--t10of12{margin-right:83.333%}.g-b--pull--t1of8{margin-right:12.5%}.g-b--pull--t3of8{margin-right:37.5%}.g-b--pull--t5of8{margin-right:62.5%}.g-b--pull--t7of8{margin-right:87.5%}.g-b--pull--t1of10{margin-right:10%}.g-b--pull--t3of10{margin-right:30%}.g-b--pull--t7of10{margin-right:70%}.g-b--pull--t9of10{margin-right:90%}.g-b--pull--t1of12{margin-right:8.333%}.g-b--pull--t5of12{margin-right:41.666%}.g-b--pull--t7of12{margin-right:58.333%}.g-b--pull--t11of12{margin-right:91.666%}.splashscreen-dillinger{width:500px}.splashscreen p{font-size:1.25rem;margin-bottom:1.43749rem;padding-top:.56251rem}.title{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.title-document{font-size:1.25rem;margin-bottom:.89999rem;padding-top:.10001rem}.menu .menu-item--save-to,.menu .menu-item--import-from{display:block}.menu .menu-item--preview,.menu .menu-item--save-to.in-sidebar,.menu .menu-item--import-from.in-sidebar{display:none}.settings a{font-size:1.25rem}.words,.characters{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.modal--dillinger.about .modal-dialog{font-size:1.25rem}.enter-zen-mode{display:block}.close-zen-mode{right:3rem;top:3rem}#zen{font-size:1.25rem;width:500px}.split-editor{border-right:1px solid #E8E8E8;float:left;padding-right:16px;width:50%}.show-preview .split-editor{display:block}.split-preview{display:block;float:right;position:relative;top:0;width:50%}#editor{font-size:1rem}.preview-mode-toggle-src,.preview-mode-toggle-html{display:block}}@media screen and (min-width:62.5em){html{font-size:.875em}body{font-size:1rem}ul,ol{margin-bottom:.83999rem;padding-top:.16001rem}p{padding-top:.66001rem}p,pre{margin-bottom:1.33999rem}pre,blockquote p{font-size:1rem;padding-top:.66001rem}blockquote p{margin-bottom:.33999rem}h1{font-size:2.0571429rem;margin-bottom:.21999rem;padding-top:.78001rem}h2{font-size:1.953125rem;margin-bottom:.1835837rem;padding-top:.8164163rem}h3{font-size:1.6457143rem;margin-bottom:.07599rem;padding-top:.92401rem}h4{font-size:1.5625rem;margin-bottom:.546865rem;padding-top:.453135rem}h5{font-size:1.25rem;margin-bottom:-.56251rem;padding-top:.56251rem}h6{font-size:1rem;margin-bottom:-.65001rem;padding-top:.65001rem}.g{margin-left:-16px;margin-right:-16px}.g-b{padding-left:16px;padding-right:16px}.g-b--d1of1{width:100%}.g-b--d1of2,.g-b--d2of4,.g-b--d3of6,.g-b--d4of8,.g-b--d5of10,.g-b--d6of12{width:50%}.g-b--d1of3,.g-b--d2of6,.g-b--d4of12{width:33.333%}.g-b--d2of3,.g-b--d4of6,.g-b--d8of12{width:66.666%}.g-b--d1of4,.g-b--d2of8,.g-b--d3of12{width:25%}.g-b--d3of4,.g-b--d6of8,.g-b--d9of12{width:75%}.g-b--d1of5,.g-b--d2of10{width:20%}.g-b--d2of5,.g-b--d4of10{width:40%}.g-b--d3of5,.g-b--d6of10{width:60%}.g-b--d4of5,.g-b--d8of10{width:80%}.g-b--d1of6,.g-b--d2of12{width:16.666%}.g-b--d5of6,.g-b--d10of12{width:83.333%}.g-b--d1of8{width:12.5%}.g-b--d3of8{width:37.5%}.g-b--d5of8{width:62.5%}.g-b--d7of8{width:87.5%}.g-b--d1of10{width:10%}.g-b--d3of10{width:30%}.g-b--d7of10{width:70%}.g-b--d9of10{width:90%}.g-b--d1of12{width:8.333%}.g-b--d5of12{width:41.666%}.g-b--d7of12{width:58.333%}.g-b--d11of12{width:91.666%}.g-b--push--d1of1{margin-left:100%}.g-b--push--d1of2,.g-b--push--d2of4,.g-b--push--d3of6,.g-b--push--d4of8,.g-b--push--d5of10,.g-b--push--d6of12{margin-left:50%}.g-b--push--d1of3,.g-b--push--d2of6,.g-b--push--d4of12{margin-left:33.333%}.g-b--push--d2of3,.g-b--push--d4of6,.g-b--push--d8of12{margin-left:66.666%}.g-b--push--d1of4,.g-b--push--d2of8,.g-b--push--d3of12{margin-left:25%}.g-b--push--d3of4,.g-b--push--d6of8,.g-b--push--d9of12{margin-left:75%}.g-b--push--d1of5,.g-b--push--d2of10{margin-left:20%}.g-b--push--d2of5,.g-b--push--d4of10{margin-left:40%}.g-b--push--d3of5,.g-b--push--d6of10{margin-left:60%}.g-b--push--d4of5,.g-b--push--d8of10{margin-left:80%}.g-b--push--d1of6,.g-b--push--d2of12{margin-left:16.666%}.g-b--push--d5of6,.g-b--push--d10of12{margin-left:83.333%}.g-b--push--d1of8{margin-left:12.5%}.g-b--push--d3of8{margin-left:37.5%}.g-b--push--d5of8{margin-left:62.5%}.g-b--push--d7of8{margin-left:87.5%}.g-b--push--d1of10{margin-left:10%}.g-b--push--d3of10{margin-left:30%}.g-b--push--d7of10{margin-left:70%}.g-b--push--d9of10{margin-left:90%}.g-b--push--d1of12{margin-left:8.333%}.g-b--push--d5of12{margin-left:41.666%}.g-b--push--d7of12{margin-left:58.333%}.g-b--push--d11of12{margin-left:91.666%}.g-b--pull--d1of1{margin-right:100%}.g-b--pull--d1of2,.g-b--pull--d2of4,.g-b--pull--d3of6,.g-b--pull--d4of8,.g-b--pull--d5of10,.g-b--pull--d6of12{margin-right:50%}.g-b--pull--d1of3,.g-b--pull--d2of6,.g-b--pull--d4of12{margin-right:33.333%}.g-b--pull--d2of3,.g-b--pull--d4of6,.g-b--pull--d8of12{margin-right:66.666%}.g-b--pull--d1of4,.g-b--pull--d2of8,.g-b--pull--d3of12{margin-right:25%}.g-b--pull--d3of4,.g-b--pull--d6of8,.g-b--pull--d9of12{margin-right:75%}.g-b--pull--d1of5,.g-b--pull--d2of10{margin-right:20%}.g-b--pull--d2of5,.g-b--pull--d4of10{margin-right:40%}.g-b--pull--d3of5,.g-b--pull--d6of10{margin-right:60%}.g-b--pull--d4of5,.g-b--pull--d8of10{margin-right:80%}.g-b--pull--d1of6,.g-b--pull--d2of12{margin-right:16.666%}.g-b--pull--d5of6,.g-b--pull--d10of12{margin-right:83.333%}.g-b--pull--d1of8{margin-right:12.5%}.g-b--pull--d3of8{margin-right:37.5%}.g-b--pull--d5of8{margin-right:62.5%}.g-b--pull--d7of8{margin-right:87.5%}.g-b--pull--d1of10{margin-right:10%}.g-b--pull--d3of10{margin-right:30%}.g-b--pull--d7of10{margin-right:70%}.g-b--pull--d9of10{margin-right:90%}.g-b--pull--d1of12{margin-right:8.333%}.g-b--pull--d5of12{margin-right:41.666%}.g-b--pull--d7of12{margin-right:58.333%}.g-b--pull--d11of12{margin-right:91.666%}.splashscreen-dillinger{width:700px}.splashscreen p{font-size:1.25rem;margin-bottom:1.43749rem;padding-top:.56251rem}.title{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.title-document{font-size:1.25rem;margin-bottom:.89999rem;padding-top:.10001rem}.menu .menu-item--export-as{display:block}.menu .menu-item--preview{display:none}.settings a{font-size:1.25rem}.words,.characters{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.modal--dillinger.about .modal-dialog,#zen{font-size:1.25rem}#zen{width:700px}#editor{font-size:1rem}}@media screen and (min-width:87.5em){html{font-size:.875em}body{font-size:1rem}ul,ol{margin-bottom:.83999rem;padding-top:.16001rem}p{padding-top:.66001rem}p,pre{margin-bottom:1.33999rem}pre,blockquote p{font-size:1rem;padding-top:.66001rem}blockquote p{margin-bottom:.33999rem}h1{font-size:2.0571429rem;margin-bottom:.21999rem;padding-top:.78001rem}h2{font-size:1.953125rem;margin-bottom:.1835837rem;padding-top:.8164163rem}h3{font-size:1.6457143rem;margin-bottom:.07599rem;padding-top:.92401rem}h4{font-size:1.5625rem;margin-bottom:.546865rem;padding-top:.453135rem}h5{font-size:1.25rem;margin-bottom:-.56251rem;padding-top:.56251rem}h6{font-size:1rem;margin-bottom:-.65001rem;padding-top:.65001rem}.splashscreen-dillinger{width:800px}.splashscreen p{font-size:1.25rem;margin-bottom:1.43749rem;padding-top:.56251rem}.title{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.title-document{margin-bottom:.89999rem;padding-top:.10001rem}.title-document,.settings a{font-size:1.25rem}.words,.characters{font-size:.8rem;margin-bottom:.77999rem;padding-top:.22001rem}.modal--dillinger.about .modal-dialog,#zen{font-size:1.25rem}#editor{font-size:1rem}}@media (min-width:768px){.form-inline .form-group{display:inline-block;margin-bottom:0;vertical-align:middle}.form-inline .form-control{display:inline-block;width:auto;vertical-align:middle}.form-inline .input-group{display:inline-table;vertical-align:middle}.form-inline .input-group .input-group-addon,.form-inline .input-group .input-group-btn,.form-inline .input-group .form-control{width:auto}.form-inline .input-group>.form-control{width:100%}.form-inline .control-label{margin-bottom:0;vertical-align:middle}.form-inline .radio,.form-inline .checkbox{display:inline-block;margin-top:0;margin-bottom:0;vertical-align:middle}.form-inline .radio label,.form-inline .checkbox label{padding-left:0}.form-inline .radio input[type="radio"],.form-inline .checkbox input[type="checkbox"]{position:relative;margin-left:0}.form-inline .has-feedback .form-control-feedback{top:0}.form-horizontal .control-label{text-align:right;margin-bottom:0;padding-top:7px}.form-horizontal .form-group-lg .control-label{padding-top:14.3px}.form-horizontal .form-group-sm .control-label{padding-top:6px}.modal-dialog{width:600px;margin:30px auto}.modal-content{box-shadow:0 5px 15px rgba(0,0,0,.5)}.modal-sm{width:300px}}@media (min-width:992px){.modal-lg{width:900px}}@media screen and (max-width:1200px){#_default_{max-width:30%}#_default_ ._default_{font-size:.825rem;line-height:.875rem;padding:12px 12px 6px 24px;text-align:justify}}@media screen and (max-width:1100px){#_default_{max-width:27%}#_default_ ._default_{font-size:.8rem;line-height:.85rem;padding:12px 6px 6px 24px;text-align:justify}}@media screen and (max-width:1000px){#_default_{max-width:24%}#_default_ ._default_{font-size:.775rem;line-height:.8rem;padding:12px 6px 6px 24px;text-align:justify}}@media screen and (max-width:900px){#_default_{max-width:30%}}@media screen and (max-width:767px){.table-responsive{width:100%;margin-bottom:15px;overflow-y:hidden;overflow-x:auto;-ms-overflow-style:-ms-autohiding-scrollbar;border:1px solid #ddd;-webkit-overflow-scrolling:touch}.table-responsive>.table{margin-bottom:0}.table-responsive>.table>thead>tr>th,.table-responsive>.table>thead>tr>td,.table-responsive>.table>tbody>tr>th,.table-responsive>.table>tbody>tr>td,.table-responsive>.table>tfoot>tr>th,.table-responsive>.table>tfoot>tr>td{white-space:nowrap}.table-responsive>.table-bordered{border:0}.table-responsive>.table-bordered>thead>tr>th:first-child,.table-responsive>.table-bordered>thead>tr>td:first-child,.table-responsive>.table-bordered>tbody>tr>th:first-child,.table-responsive>.table-bordered>tbody>tr>td:first-child,.table-responsive>.table-bordered>tfoot>tr>th:first-child,.table-responsive>.table-bordered>tfoot>tr>td:first-child{border-left:0}.table-responsive>.table-bordered>thead>tr>th:last-child,.table-responsive>.table-bordered>thead>tr>td:last-child,.table-responsive>.table-bordered>tbody>tr>th:last-child,.table-responsive>.table-bordered>tbody>tr>td:last-child,.table-responsive>.table-bordered>tfoot>tr>th:last-child,.table-responsive>.table-bordered>tfoot>tr>td:last-child{border-right:0}.table-responsive>.table-bordered>tbody>tr:last-child>th,.table-responsive>.table-bordered>tbody>tr:last-child>td,.table-responsive>.table-bordered>tfoot>tr:last-child>th,.table-responsive>.table-bordered>tfoot>tr:last-child>td{border-bottom:0}}@media screen and (max-width:720px){#_default_{max-width:60%}#_default_ ._default_{font-size:.75rem;line-height:1rem;padding:12px 24px}}@media screen and (max-width:620px){#_default_{max-width:50%}#_default_ ._default_{font-size:.66rem;letter-spacing:1px;line-height:1rem;padding:10px 24px}}@media screen and (max-width:520px){#_default_ ._default_{font-size:.4rem;line-height:.875rem;padding:6px 12px 6px 24px;text-align:justify}}@media screen and (max-width:460px){#_default_{display:none}}@media screen and (max-width:46.1875em){.editor-header{display:none}.editor-header--first{display:block;width:100%}}</style></head><body id="preview">
<h1 class="code-line" data-line-start=0 data-line-end=1><a id="Your_First_REST_API_0"></a>Your First REST API</h1>
<h3 class="code-line" data-line-start=2 data-line-end=3><a id="Starter_app_2"></a>Starter app</h3>
<pre><code class="has-line-data" data-line-start="5" data-line-end="15" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask

app = Flask(__name__)

<span class="hljs-decorator">@app.route('/')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">home</span><span class="hljs-params">()</span>:</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">"hello world"</span>

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<pre><code class="has-line-data" data-line-start="17" data-line-end="86" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, jsonify, request

<span class="hljs-comment"># Request enables to capture POST requests. We don't need it for GET request as Flask does all that on its own</span>

app = Flask(__name__)

stores = [
  {
    <span class="hljs-string">'name'</span>: <span class="hljs-string">'store 1'</span>,
    items: [
      {
        <span class="hljs-string">'name'</span>: <span class="hljs-string">'My Item'</span>,
        <span class="hljs-string">'price'</span>: <span class="hljs-number">14.99</span>
      }
    ]
  }
]

<span class="hljs-decorator">@app.route('/store', methods=['POST'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_store</span><span class="hljs-params">()</span>:</span>
  request_data = request.get_json() <span class="hljs-comment"># This converts the JSON to python dictionary</span>
  new_store = {
    <span class="hljs-string">'name'</span>: request_data[<span class="hljs-string">'name'</span>],
    <span class="hljs-string">'items'</span>: []
  }
  stores.append(new_store) <span class="hljs-comment"># Appending to the original stores list</span>
  <span class="hljs-keyword">return</span> jsonify(new_store) <span class="hljs-comment"># we are returning the store to tell the request was successful </span>

<span class="hljs-decorator">@app.route('/store')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_stores</span><span class="hljs-params">()</span>:</span>
<span class="hljs-comment"># GET /store</span>
<span class="hljs-comment"># gets all the stores </span>
<span class="hljs-comment"># json requires json to be be sent but stores is a list; So we need to convert it to JSON/Dictionary</span>
  <span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'stores'</span>: stores})


<span class="hljs-decorator">@app.route('/store/&lt;string:name&gt;')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_store</span><span class="hljs-params">(name)</span>:</span>
<span class="hljs-comment"># GET request /store/store 1</span>
<span class="hljs-comment"># Gets specific store</span>
  <span class="hljs-keyword">for</span> store <span class="hljs-keyword">in</span> stores:
    <span class="hljs-keyword">if</span> store[<span class="hljs-string">'name'</span>] == name: <span class="hljs-comment"># name is from string:name</span>
      <span class="hljs-keyword">return</span> jsonify(store) <span class="hljs-comment"># store is a dictionary already </span>
  <span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'message'</span>: <span class="hljs-string">'store not found'</span>})
  <span class="hljs-keyword">pass</span>

<span class="hljs-decorator">@app.route('/store/&lt;string:name&gt;/item')</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_item_store</span><span class="hljs-params">(name)</span>:</span>
  <span class="hljs-keyword">for</span> store <span class="hljs-keyword">in</span> stores:
    <span class="hljs-keyword">if</span> store[<span class="hljs-string">'name'</span>] == name:
      <span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'items'</span>: stores[<span class="hljs-string">'items'</span>]}) <span class="hljs-comment"># store items is a list</span>
  <span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'message'</span>: <span class="hljs-string">'store not found'</span>})

<span class="hljs-decorator">@app.route('/store/&lt;string:name&gt;/item', methods=['POST'])</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_item_store</span><span class="hljs-params">(name)</span>:</span>
  request_data = request.get_json()
  <span class="hljs-keyword">for</span> store <span class="hljs-keyword">in</span> stores:
    <span class="hljs-keyword">if</span> store[<span class="hljs-string">'name'</span>] == name:
      new_item = {
        <span class="hljs-string">'name'</span>: request_data[<span class="hljs-string">'name'</span>],
        <span class="hljs-string">'price'</span>: request_data[<span class="hljs-string">'price'</span>] 
      }
      store[<span class="hljs-string">'items'</span>].append(new_item)
      <span class="hljs-keyword">return</span> jsonify(new_item)
  <span class="hljs-keyword">return</span> jsonify({<span class="hljs-string">'message'</span>: <span class="hljs-string">'store not found'</span>})


app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 class="code-line" data-line-start=88 data-line-end=89><a id="Sending_JSON_with_Postman_88"></a>Sending JSON with Postman</h3>
<p class="has-line-data" data-line-start="90" data-line-end="91">Select <code>create</code> then on the <code>headers</code></p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-Type</td>
<td>application/json</td>
</tr>
</tbody>
</table>
<p class="has-line-data" data-line-start="96" data-line-end="97">Select <code>body</code> and select <code>raw</code></p>
<pre><code class="has-line-data" data-line-start="99" data-line-end="103" class="language-json">{
  "<span class="hljs-attribute">name</span>": <span class="hljs-value"><span class="hljs-string">"another store"</span>
</span>}
</code></pre>
<h1 class="code-line" data-line-start=104 data-line-end=105><a id="Flask_RESTful_104"></a>Flask RESTful</h1>
<h3 class="code-line" data-line-start=106 data-line-end=107><a id="Virtual_Environment_106"></a>Virtual Environment</h3>
<p class="has-line-data" data-line-start="108" data-line-end="109"><code>pip install virtualenv</code></p>
<p class="has-line-data" data-line-start="110" data-line-end="111"><code>virtualenv venv --python=python3.8</code></p>
<p class="has-line-data" data-line-start="112" data-line-end="113"><code>venv</code> is the directory name</p>
<p class="has-line-data" data-line-start="114" data-line-end="115"><code>python3.8</code> is declaration of the python version to be used</p>
<p class="has-line-data" data-line-start="116" data-line-end="117">To activate the <code>venv</code> &gt;&gt; <code>./venv/Scripts/activate.bat</code></p>
<p class="has-line-data" data-line-start="118" data-line-end="119">To exit/deactivate the <code>venv</code> &gt;&gt; <code>deactivate</code></p>
<p class="has-line-data" data-line-start="120" data-line-end="121"><code>pip freeze</code> lets us see the modules in the venv</p>
<p class="has-line-data" data-line-start="122" data-line-end="123">Preferably create a separate directory and work in it.</p>
<h3 class="code-line" data-line-start=124 data-line-end=125><a id="Getting_started_124"></a>Getting started</h3>
<pre><code class="has-line-data" data-line-start="127" data-line-end="143" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api

app = Flask(__name__) <span class="hljs-comment"># Flask module</span>
api = Api(app) <span class="hljs-comment"># We are calling the flask module's app into the flask-restful's import of API</span>

<span class="hljs-comment"># Student example</span>

Class Student(Resource):
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'student'</span>: name}

api.add_resource(Student, <span class="hljs-string">'/student/&lt;string:name&gt;'</span>) <span class="hljs-comment"># We don't have decorators to declare the route; We are just GET</span>

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 class="code-line" data-line-start=144 data-line-end=145><a id="Test_first_design_API_using_Postman_144"></a>Test first design API using Postman</h3>
<p class="has-line-data" data-line-start="146" data-line-end="147">Design the API endpoints in collections section and saving each request endpoints there.</p>
<p class="has-line-data" data-line-start="148" data-line-end="149"><code>PUT</code> creates an entry if it doesnt exists or it will update it if it exists.</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Request Type</th>
<th>Endpoint</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/items</td>
</tr>
<tr>
<td>GET</td>
<td>/items/&lt;name&gt;</td>
</tr>
<tr>
<td>POST</td>
<td>/items/&lt;name&gt;</td>
</tr>
<tr>
<td>DEL</td>
<td>/items/&lt;name&gt;</td>
</tr>
<tr>
<td>PUT</td>
<td>/items/&lt;name&gt;</td>
</tr>
</tbody>
</table>
<h3 class="code-line" data-line-start=158 data-line-end=159><a id="Creating_item_resources_158"></a>Creating item resources</h3>
<pre><code class="has-line-data" data-line-start="161" data-line-end="215" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api

items = []

app = Flask(__name__) <span class="hljs-comment"># Flask module</span>
api = Api(app) <span class="hljs-comment"># We are calling the flask module's app into the flask-restful's import of API</span>

Class Item(Resource):
<span class="hljs-comment">## FORMER CHAPTER!! </span>
  <span class="hljs-comment"># def get(self, name):</span>
  <span class="hljs-comment">#   for item in items:</span>
  <span class="hljs-comment">#     if item['name'] == name:</span>
  <span class="hljs-comment">#       return item # we don't need to use jsonify as Flask-RESTful handles that for us</span>
  <span class="hljs-comment">#   return {'item': None}, 404  # It is healthy to return a JSON rather than direct None/null</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>) <span class="hljs-comment"># Just a filter with function to find the item from items</span>
    <span class="hljs-comment"># TIL next. when there is a single item in iterable (filter item, list item) "next" allows for the first item to be capture i.e. i[0]. Calling it again is i[1]</span>
    <span class="hljs-comment"># next(iterable, None) &gt; allows for error capture index out of ... with None</span>
    <span class="hljs-comment"># In one statement we are either showing the item or None</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span> <span class="hljs-comment"># &gt;&gt; return {'item': item}, 200 if item is not None else 404</span>
    <span class="hljs-comment"># So either item 200 or None 404; the conditional deals with the the error code bit</span>

<span class="hljs-comment">## Taking the data in (POST) from URL params only; not with JSON (with Flask Request); FORMER CHAPTER</span>
  <span class="hljs-comment"># def post(self, name):</span>
  <span class="hljs-comment">#   item = {'name': name, 'price': 12} # we have set an arbitrary price; we just passing the data with the URL not with the body; We don't need Flask request for that</span>
  <span class="hljs-comment">#   items.append(item)</span>
  <span class="hljs-comment">#   return item, 201  # item is a dictionary; It is better to add the HTTP status code; 201 &gt; Created; 202 &gt; Accepted/Delaying creation; 200 &gt; Ok (defualt)</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-comment"># What to do when an item already exists</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>): <span class="hljs-comment"># with if we are already testing truthy-falsy value</span>
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span> <span class="hljs-comment"># 400 Bad request</span>
    
    <span class="hljs-comment"># requires a JSON payload and appropriate content type header</span>
    data = request.get_json(
      force=<span class="hljs-keyword">True</span> <span class="hljs-comment"># If you don't have content-type header it will forcefully convert to JSON; DO NOT USE IT!!</span>
      silent=<span class="hljs-keyword">True</span> <span class="hljs-comment"># Silent doesn't give an error message when something goes wrong; it simply returns True</span>
    )
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]} <span class="hljs-comment"># We are getting name from URL params; Price from JSON payload</span>
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>) <span class="hljs-comment"># We don't have decorators to declare the route; We are just GET</span>
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 class="code-line" data-line-start=216 data-line-end=217><a id="Authentication_216"></a>Authentication</h3>
<p class="has-line-data" data-line-start="218" data-line-end="219">![Diagram](JWT authentication.png)</p>
<p class="has-line-data" data-line-start="220" data-line-end="221">install <code>Flask-JWT</code>. <code>JWT</code> allows decrypting data.</p>
<p class="has-line-data" data-line-start="222" data-line-end="223">two files -</p>
<ol>
<li class="has-line-data" data-line-start="224" data-line-end="225"><code>app.py</code></li>
<li class="has-line-data" data-line-start="225" data-line-end="226"><code>security.py</code></li>
<li class="has-line-data" data-line-start="226" data-line-end="227"><code>user.py</code></li>
</ol>
<h5 class="code-line" data-line-start=229 data-line-end=230><a id="2_securitypy_FORMER_CODE_229"></a>2. <a href="http://security.py">security.py</a> (FORMER CODE)</h5>
<p class="has-line-data" data-line-start="231" data-line-end="232">This is security section for authenticating stuff</p>
<pre><code class="has-line-data" data-line-start="234" data-line-end="276" class="language-python">
<span class="hljs-comment"># this is your list of authenticated users</span>

users = [
 {
   <span class="hljs-string">'id'</span>: <span class="hljs-number">1</span>,
   <span class="hljs-string">'username'</span>: <span class="hljs-string">'bob'</span>,
   <span class="hljs-string">'password'</span>: <span class="hljs-string">'asdf'</span>
 } 
]

<span class="hljs-comment"># repeated from previously</span>
username_mapping = {
  <span class="hljs-string">'bob'</span>: {
   <span class="hljs-string">'id'</span>: <span class="hljs-number">1</span>,
   <span class="hljs-string">'username'</span>: <span class="hljs-string">'bob'</span>,
   <span class="hljs-string">'password'</span>: <span class="hljs-string">'asdf'</span>
 } 
}

<span class="hljs-comment"># repeated from previously</span>

userid_mapping = {<span class="hljs-number">1</span>: {
   <span class="hljs-string">'id'</span>: <span class="hljs-number">1</span>,
   <span class="hljs-string">'username'</span>: <span class="hljs-string">'bob'</span>,
   <span class="hljs-string">'password'</span>: <span class="hljs-string">'asdf'</span>
 } 
}

<span class="hljs-comment"># The reason we did this is because we can conveniently find the user based on username or userid.</span>
<span class="hljs-comment"># Allows for skipping iteration</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate</span><span class="hljs-params">(username, password)</span>:</span>
  user = username_mapping.get(username, <span class="hljs-keyword">None</span>) <span class="hljs-comment"># get dictionary method; if not found returns None</span>
  <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> user.password == password:
  <span class="hljs-comment"># validates the user if it is not None and checks password</span>
    <span class="hljs-keyword">return</span> user

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">identity</span><span class="hljs-params">(payload)</span>:</span>
  user_id = payload[<span class="hljs-string">'identity'</span>] <span class="hljs-comment"># gets the userid from the payload</span>
  <span class="hljs-keyword">return</span> userid_mapping.get(user_id, <span class="hljs-keyword">None</span>) <span class="hljs-comment"># checks if the payload userid exists in the userid_mapping</span>
</code></pre>
<h5 class="code-line" data-line-start=277 data-line-end=278><a id="3_userpy_277"></a>3. <a href="http://user.py">user.py</a></h5>
<p class="has-line-data" data-line-start="279" data-line-end="280">This is going to allow you to use class based objects for storing user data rather then storing them in a dictionary in the <a href="http://security.py">security.py</a></p>
<pre><code class="has-line-data" data-line-start="282" data-line-end="288" class="language-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id <span class="hljs-comment"># "id" is a python keyword so we added the "_"; We could have used userid too</span>
    self.username =  username
    self.password =  password
</code></pre>
<h5 class="code-line" data-line-start=290 data-line-end=291><a id="2_securitypy_290"></a>2. <a href="http://security.py">security.py</a></h5>
<pre><code class="has-line-data" data-line-start="293" data-line-end="319" class="language-python">
<span class="hljs-keyword">from</span> werkzeug.security <span class="hljs-keyword">import</span> safe_str_cmp
<span class="hljs-comment"># allows you to compare strings across all encoding standards (utf, unicode, ascii...)</span>
<span class="hljs-comment"># we will be using it in the authenticate function</span>
<span class="hljs-keyword">from</span> user <span class="hljs-keyword">import</span> User
<span class="hljs-comment"># user.py &gt; class User</span>

users = [
  User(<span class="hljs-number">1</span>, <span class="hljs-string">'bob'</span>, <span class="hljs-string">'asdf'</span>)
  <span class="hljs-comment"># User (_id, username, password)</span>
]

<span class="hljs-comment"># dictionary comprehension that has username as key &amp; dictionary itself as value</span>
username_mapping = {u.username: u <span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> users}
userid_mapping = {u.id: u <span class="hljs-keyword">for</span> u <span class="hljs-keyword">in</span> users}


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate</span><span class="hljs-params">(username, password)</span>:</span>
  user = username_mapping.get(username, <span class="hljs-keyword">None</span>)
  <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> safe_str_cmp(user.password, password)
    <span class="hljs-keyword">return</span> user

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">identity</span><span class="hljs-params">(payload)</span>:</span>
  user_id = payload[<span class="hljs-string">'identity'</span>]
  <span class="hljs-keyword">return</span> userid_mapping.get(user_id, <span class="hljs-keyword">None</span>)
</code></pre>
<h5 class="code-line" data-line-start=320 data-line-end=321><a id="1_apppy_320"></a>1. <a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="323" data-line-end="378" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-comment"># we made request using username and password; And we got a JWT confirming our existence in the user object</span>
<span class="hljs-comment"># to validate every future request we make we are going to need send something with that request</span>
<span class="hljs-comment"># to show we are the validated user</span>

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>
<span class="hljs-comment"># we are using the authenticate and the identity function from the security app</span>
<span class="hljs-comment"># this creates a new endpoint called "/auth"</span>
<span class="hljs-comment"># we can pass the username and password through that endpoint</span>
<span class="hljs-comment"># this password and username is sent over to authenticate function</span>
<span class="hljs-comment"># the authenticate function returns the user object</span>
<span class="hljs-comment"># authenticate generates the JWT</span>
<span class="hljs-comment"># authenticate deals with /auth endpoint only</span>
<span class="hljs-comment"># the returned user object helps to generate the JWT</span>
<span class="hljs-comment"># for every other requests we are using the identity function</span>
<span class="hljs-comment"># with every request "payload" there is the JWT</span>
<span class="hljs-comment"># and the "payload" of request is first validated by the identitfy function</span>
<span class="hljs-comment"># the identity function validates requests with the JWT to make sure it is the same user making the requests</span>
<span class="hljs-comment"># identity function ensures further requests with validated JWT </span>


items = []
Class Item(Resource):
<span class="hljs-decorator">  @jwt_required() # Means that we need have the JWT (or be authenticated) to make the get request</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span>
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = request.get_json()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h5 class="code-line" data-line-start=380 data-line-end=381><a id="Postman_sending_credentials_on_auth_380"></a>Postman sending credentials on /auth</h5>
<p class="has-line-data" data-line-start="382" data-line-end="383">go to <code>/auth</code>. Select <code>POST</code></p>
<p class="has-line-data" data-line-start="384" data-line-end="385">Headers</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Content-Type</td>
<td>application/json</td>
</tr>
</tbody>
</table>
<p class="has-line-data" data-line-start="390" data-line-end="391">send body -</p>
<pre><code class="has-line-data" data-line-start="392" data-line-end="397" class="language-json">{
  "<span class="hljs-attribute">username</span>": <span class="hljs-value"><span class="hljs-string">"bob"</span></span>,
  "<span class="hljs-attribute">password</span>": <span class="hljs-value"><span class="hljs-string">"asdf"</span>
</span>}
</code></pre>
<p class="has-line-data" data-line-start="398" data-line-end="399">Needs to match what we have in <a href="http://security.py">security.py</a></p>
<p class="has-line-data" data-line-start="400" data-line-end="401">Now in the response you will see the <code>JWT</code> or the <code>access token</code></p>
<p class="has-line-data" data-line-start="402" data-line-end="403">Now copy the access token</p>
<p class="has-line-data" data-line-start="404" data-line-end="405">Now make a GET request to <code>item/something</code> and You will not see that because you are not authenticated. 401 is unauthorized.</p>
<p class="has-line-data" data-line-start="406" data-line-end="407">Now make the request with -</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Authorization</td>
<td>JWT *access token*</td>
</tr>
</tbody>
</table>
<h3 class="code-line" data-line-start=412 data-line-end=413><a id="Delete__Put_412"></a>Delete &amp; Put</h3>
<h5 class="code-line" data-line-start=414 data-line-end=415><a id="apppy_414"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="417" data-line-end="470" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT, jwt_required

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity)

items = []
Class Item(Resource):
<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span>
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = request.get_json()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
     <span class="hljs-keyword">global</span> items <span class="hljs-comment"># We need it here. Or we are going to be calling function scope problems.</span>
     items = list(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items))
     <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item deleted'</span>}
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-comment"># put updates or creates</span>
    data = request.get_json()
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 class="code-line" data-line-start=471 data-line-end=472><a id="Advanced_Request_Parsing_471"></a>Advanced Request Parsing</h3>
<p class="has-line-data" data-line-start="473" data-line-end="474">Allows for selectively choosing fields in the request level using <code>reqparse</code>. Helps to secure data too.</p>
<h5 class="code-line" data-line-start=475 data-line-end=476><a id="apppy_475"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="478" data-line-end="541" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT, jwt_required
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> reqparse
<span class="hljs-comment"># For request parsing argument, type enforcement....; we are using it in the PUT function</span>

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity)

items = []
Class Item(Resource):
<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span>
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = request.get_json()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
     <span class="hljs-keyword">global</span> items
     items = list(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items))
     <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item deleted'</span>}
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    parser =  reqparse.RequestParser()
    parser.add_argument(
      <span class="hljs-string">'price'</span>, <span class="hljs-comment"># the field will get passed only; nothing else will.</span>
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
    )
    <span class="hljs-comment"># data = request.get_json()</span>
    data = parser.parse_args()

    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h3 class="code-line" data-line-start=543 data-line-end=544><a id="Optimizing_the_code_543"></a>Optimizing the code</h3>
<h5 class="code-line" data-line-start=545 data-line-end=546><a id="apppy_545"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="548" data-line-end="615" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT, jwt_required
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> reqparse
<span class="hljs-comment"># For request parsing argument, type enforcement....; we are using it in the PUT function</span>

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity)

items = []
Class Item(Resource):
  <span class="hljs-comment"># As we are going to use the reqparse across request methods</span>
  <span class="hljs-comment"># we want to make sure everyone has access to it</span>
  <span class="hljs-comment"># we need to put it in here rather than adding it to every function</span>
  <span class="hljs-comment"># this is not a "self" object rather a "Item" object</span>
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>, <span class="hljs-comment"># the field will get passed only; nothing else will.</span>
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span>
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args() <span class="hljs-comment"># We put it here because we first deal with the validation then we deal with the request</span>
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
     <span class="hljs-keyword">global</span> items
     items = list(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items))
     <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item deleted'</span>}
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    data = parser.parse_args()

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h1 class="code-line" data-line-start=616 data-line-end=617><a id="Storing_Resources_616"></a>Storing Resources</h1>
<h3 class="code-line" data-line-start=618 data-line-end=619><a id="Runnings_a_SQLite_database_618"></a>Runnings a SQLite database</h3>
<pre><code class="has-line-data" data-line-start="621" data-line-end="668" class="language-python"><span class="hljs-keyword">import</span> sqlite3

connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
<span class="hljs-comment"># connection establishes the connection between the module and the db</span>

cursor = connection.cursor()
<span class="hljs-comment"># cursor is like GUI cursor. It allows to select, retrieve, store and manipulate things (db).</span>

create_table = <span class="hljs-string">"CREATE TABLE users(id int, username text, password text)"</span>
<span class="hljs-comment"># CREATE TABLE is the command</span>
<span class="hljs-comment"># users is the name of the table</span>
<span class="hljs-comment"># id, username, password is the columns</span>

cursor.execute(create_table)
<span class="hljs-comment"># we pass the command (variable) to the cursor &gt; connection &gt; data.db</span>
<span class="hljs-comment"># Now the db has been created</span>

user = (<span class="hljs-number">1</span>, <span class="hljs-string">'abd'</span>, <span class="hljs-string">'asdf'</span>)
insert_query = <span class="hljs-string">"INSERT INTO users VALUES (?, ?, ?)"</span>
<span class="hljs-comment"># SQL query (command)</span>
<span class="hljs-comment"># INSERT INTO &gt; command</span>
<span class="hljs-comment"># users &gt; location/table</span>
<span class="hljs-comment"># (?, ?, ?) &gt; place things there. Think of it as "{} {} {}".format(*stuff)</span>

cursor.execute(insert_query, user)


users = [
  (<span class="hljs-number">2</span>, <span class="hljs-string">'bad'</span>, <span class="hljs-string">'asdf'</span>),
  (<span class="hljs-number">3</span>, <span class="hljs-string">'cad'</span>, <span class="hljs-string">'gasfdg'</span>)
]

cursor.executemany(insert_query, users)
<span class="hljs-comment"># iterates and inserts all of them</span>

select_query = <span class="hljs-string">"SELECT * FROM users"</span>
<span class="hljs-comment"># SELECT &gt; Select for retrieving data</span>
<span class="hljs-comment"># * &gt; Column name. "*" means all; you can name specific column too like "id"</span>
<span class="hljs-comment"># users &gt; table name</span>

<span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> cursor.execute(select_query):
<span class="hljs-comment"># we execute the command and it returns a list of rows(tuples) from the db</span>
  print(row)

connection.commit() <span class="hljs-comment"># more like connection.save()</span>
connection.close() <span class="hljs-comment"># need to close it</span>
</code></pre>
<h3 class="code-line" data-line-start=670 data-line-end=671><a id="Logging_and_retrieving_Users_from_Database_670"></a>Logging and retrieving Users from Database</h3>
<p class="has-line-data" data-line-start="672" data-line-end="673">We are going to use the db we created previously.</p>
<h5 class="code-line" data-line-start=674 data-line-end=675><a id="userpy_674"></a><a href="http://user.py">user.py</a></h5>
<pre><code class="has-line-data" data-line-start="677" data-line-end="707" class="language-python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id
    self.username =  username
    self.password =  password
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(self, username)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * from users WHERE username=?"</span>
    <span class="hljs-comment"># WHERE &gt; limits rows where username is equal to something/parameter</span>

    result = cursor.execute(query, (username,))
    <span class="hljs-comment"># we need always pass params to SQL in tuple</span>
    <span class="hljs-comment"># (username,) &gt; just having ('bob') == 'bob'; adding the trailing comma converts it to a tuple ('bob')</span>

    row = result.fetchone() <span class="hljs-comment"># Gets the first result from the results iterable (a bit like next); but it returns None automatically when empty</span>
    <span class="hljs-keyword">if</span> row: <span class="hljs-comment"># if row is not None</span>
      user = User(row[<span class="hljs-number">0</span>], row[<span class="hljs-number">1</span>], row[<span class="hljs-number">2</span>])
      <span class="hljs-comment"># adds to the User class object</span>
      <span class="hljs-comment"># _id, username, password = (2, 'bad', 'asdf')</span>
    <span class="hljs-keyword">else</span>:
      user = <span class="hljs-keyword">None</span>

    connection.close() <span class="hljs-comment"># don't need to commit as we did not write</span>
    <span class="hljs-keyword">return</span> user <span class="hljs-comment"># User object or None</span>
</code></pre>
<h3 class="code-line" data-line-start=709 data-line-end=710><a id="CLS_implication_in_logging_and_retrieving_709"></a>CLS implication in logging and retrieving</h3>
<p class="has-line-data" data-line-start="711" data-line-end="712">CLS or classmethod is used when inside the class the class itself is being referenced.</p>
<h5 class="code-line" data-line-start=713 data-line-end=714><a id="userpy_713"></a><a href="http://user.py">user.py</a></h5>
<pre><code class="has-line-data" data-line-start="716" data-line-end="758" class="language-python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id
    self.username =  username
    self.password =  password
  
<span class="hljs-decorator">  @classmethod # new add</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(cls, username)</span>:</span> <span class="hljs-comment"># self changed to cls</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()
    query = <span class="hljs-string">"SELECT * from users WHERE username=?"</span>
    result = cursor.execute(query, (username,))

    row = result.fetchone()
    <span class="hljs-keyword">if</span> row:
      user = cls(*row)
      <span class="hljs-comment"># converted User class to cls</span>
      <span class="hljs-comment"># converted the individual tuple indexing to tuple spread using *row</span>
    <span class="hljs-keyword">else</span>:
      user = <span class="hljs-keyword">None</span>

    connection.close()
    <span class="hljs-keyword">return</span> user

<span class="hljs-decorator">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_id</span><span class="hljs-params">(cls, _id)</span>:</span>
      connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
      cursor = connection.cursor()
      query = <span class="hljs-string">"SELECT * from users WHERE id=?"</span>
      result = cursor.execute(query, (_id,))

      row = result.fetchone()
      <span class="hljs-keyword">if</span> row:
        user = cls(*row)
      <span class="hljs-keyword">else</span>:
        user = <span class="hljs-keyword">None</span>

      connection.close()
      <span class="hljs-keyword">return</span> user
</code></pre>
<h5 class="code-line" data-line-start=759 data-line-end=760><a id="securitypy_759"></a><a href="http://security.py">security.py</a></h5>
<pre><code class="has-line-data" data-line-start="762" data-line-end="786" class="language-python">
<span class="hljs-keyword">from</span> werkzeug.security <span class="hljs-keyword">import</span> safe_str_cmp
<span class="hljs-keyword">from</span> user <span class="hljs-keyword">import</span> User


<span class="hljs-comment">## This section is transferred to db</span>
<span class="hljs-comment"># users = [</span>
<span class="hljs-comment">#   User(1, 'bob', 'asdf')</span>
<span class="hljs-comment"># ]</span>

<span class="hljs-comment">## This section is removed by User.find_by_username &amp; User.find_by_id</span>
<span class="hljs-comment"># username_mapping = {u.username: u for u in users}</span>
<span class="hljs-comment"># userid_mapping = {u.id: u for u in users}</span>


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate</span><span class="hljs-params">(username, password)</span>:</span>
  user = User.find_by_username(username) <span class="hljs-comment"># From User class</span>
  <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> safe_str_cmp(user.password, password)
    <span class="hljs-keyword">return</span> user

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">identity</span><span class="hljs-params">(payload)</span>:</span>
  user_id = payload[<span class="hljs-string">'identity'</span>]
  <span class="hljs-keyword">return</span> User.find_by_id(user_id) <span class="hljs-comment"># From User class</span>
</code></pre>
<h3 class="code-line" data-line-start=787 data-line-end=788><a id="Signing_up_and_writing_users_to_database_787"></a>Signing up and writing users to database</h3>
<h5 class="code-line" data-line-start=789 data-line-end=790><a id="create_tablespy_789"></a>create_tables.py</h5>
<pre><code class="has-line-data" data-line-start="792" data-line-end="809" class="language-python"><span class="hljs-keyword">import</span> sqlite3

connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
cursor = connection.cursor()

<span class="hljs-comment"># create_table = "CREATE TABLE IF NOT EXISTS users (id int, username text, password text)"</span>
create_table = <span class="hljs-string">"CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, username text, password text)"</span>
<span class="hljs-comment"># CREATE TABLE // IF NOT EXISTS are two different commands</span>
<span class="hljs-comment"># We don't want to "manually" add ids; we should auto increment this column</span>
<span class="hljs-comment"># INTEGER allows 'auto incrementing column'; int does not</span>
<span class="hljs-comment"># Now we just need to assign username and password; id will be auto incremented.</span>

cursor.execute(create_table)

connection.commit()
connection.close()
</code></pre>
<h5 class="code-line" data-line-start=810 data-line-end=811><a id="userspy_810"></a><a href="http://users.py">users.py</a></h5>
<p class="has-line-data" data-line-start="812" data-line-end="813">We need to allow users to sign up. The existing <code>User</code> class allows to find users.</p>
<p class="has-line-data" data-line-start="814" data-line-end="815">But we are going to create a separate system that allows the users to sign up. We are going to use <strong>flask resource</strong> for that.</p>
<pre><code class="has-line-data" data-line-start="817" data-line-end="886" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">import</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id
    self.username =  username
    self.password =  password
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(cls, username)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()
    query = <span class="hljs-string">"SELECT * from users WHERE username=?"</span>
    result = cursor.execute(query, (username,))
    row = result.fetchone()
    user = cls(*row) <span class="hljs-keyword">if</span> row <span class="hljs-keyword">else</span> <span class="hljs-keyword">None</span>
    connection.close()
    <span class="hljs-keyword">return</span> user

<span class="hljs-decorator">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_id</span><span class="hljs-params">(cls, _id)</span>:</span>
      connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
      cursor = connection.cursor()
      query = <span class="hljs-string">"SELECT * from users WHERE id=?"</span>
      result = cursor.execute(query, (_id,))
      row = result.fetchone()
      user = cls(*row) <span class="hljs-keyword">if</span> row <span class="hljs-keyword">else</span> <span class="hljs-keyword">None</span>
      connection.close()
      <span class="hljs-keyword">return</span> user

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegister</span><span class="hljs-params">(Resource)</span>:</span> <span class="hljs-comment">#/register</span>
<span class="hljs-comment"># The user signup resource class</span>
  parser = reqparse.RequestParser()
  parser.add_argument(
    <span class="hljs-string">'username'</span>,
    type=str,
    required=<span class="hljs-keyword">True</span>,
    help=<span class="hljs-string">"This field is required"</span>
  )
  parser.add_argument(
    <span class="hljs-string">'password'</span>,
    type=str,
    required=<span class="hljs-keyword">True</span>,
    help=<span class="hljs-string">"This field is required"</span>
  )
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self)</span>:</span>
    data = UserRegister.parser.add_args()

    <span class="hljs-keyword">if</span> User.find_by_username(data[<span class="hljs-string">'username'</span>]):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"A user with that username already exists"</span>}, <span class="hljs-number">400</span>
    <span class="hljs-comment"># if the user does not exist we create</span>

    connection =  sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO users VALUES (NULL, ?, ?)"</span>
    <span class="hljs-comment"># INSERT INTO the users table</span>
    <span class="hljs-comment"># VALUES &gt; command</span>
    <span class="hljs-comment"># We have put NULL there for the auto incrementing id. We can't even leave it empty.</span>
    <span class="hljs-comment"># The question marks are where we are going to put in data using tuples</span>

    cursor.execute(query, (data[<span class="hljs-string">'username'</span>], data[<span class="hljs-string">'password'</span>]))
    
    connection.commit()
    connection.close()

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'User created successfully'</span>}, <span class="hljs-number">201</span>
</code></pre>
<h5 class="code-line" data-line-start=887 data-line-end=888><a id="apppy_887"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="891" data-line-end="955" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT, jwt_required
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> reqparse

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> user <span class="hljs-keyword">import</span> UserRegister

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity)

items = []
Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: item}, <span class="hljs-number">200</span> <span class="hljs-keyword">if</span> item <span class="hljs-keyword">else</span> <span class="hljs-number">404</span>
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
     <span class="hljs-keyword">global</span> items
     items = list(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items))
     <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item deleted'</span>}
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    data = parser.parse_args()

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>) <span class="hljs-comment"># Registering user signup in; /auth != /register</span>

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h5 class="code-line" data-line-start=956 data-line-end=957><a id="Postman_956"></a>Postman</h5>
<p class="has-line-data" data-line-start="958" data-line-end="959">We will POST to /register to create the user. Then we will POST to /auth to get the access token then we can use it.</p>
<h3 class="code-line" data-line-start=960 data-line-end=961><a id="Retriving_our_item_resources_from_a_database_960"></a>Retriving our item resources from a database</h3>
<p class="has-line-data" data-line-start="962" data-line-end="963">Cut and paste the <code>item</code> and <code>itemlist</code> resources from <code>app.py</code> and paste them into a new file <code>item.py</code></p>
<h5 class="code-line" data-line-start=964 data-line-end=965><a id="itempy_964"></a><a href="http://item.py">item.py</a></h5>
<pre><code class="has-line-data" data-line-start="967" data-line-end="1026" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resoruce, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-comment"># item = next(filter(lambda x: x['name'] == name, items), None)</span>
    <span class="hljs-comment"># return {'item': item}, 200 if item else 404</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor

    query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
    result = cursor.execute(query, (name,))
    row = result.fetchone()
    connection.close()

    <span class="hljs-keyword">if</span> row:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>:row[<span class="hljs-number">1</span>]}}
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items), <span class="hljs-keyword">None</span>):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}
    items.append(item)
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
     <span class="hljs-keyword">global</span> items
     items = list(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>]==name, items))
     <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item deleted'</span>}
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    data = parser.parse_args()

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<h5 class="code-line" data-line-start=1027 data-line-end=1028><a id="apppy_1027"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="1030" data-line-end="1060" class="language-python"><span class="hljs-comment"># from flask import Flask, request  # Don't need request</span>
<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-comment"># from flask_restful import Resource, Api, reqparse # Don't need resource, reqpares</span>
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-comment"># from flask_jwt import JWT, jwt_required # Don't need jwt_required</span>
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> item <span class="hljs-keyword">import</span> Item, Itemlist <span class="hljs-comment"># import the classes (resources) from item.py</span>

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)
jwt = JWT(app, authenticate, identity)

<span class="hljs-comment">#  items = [] # Don't need it</span>
  

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>) <span class="hljs-comment"># Registering user signup in; /auth != /register</span>

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">'__main___'</span>:
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
<span class="hljs-comment"># Why?</span>
<span class="hljs-comment"># In python when you import something python runs that file</span>
<span class="hljs-comment"># but except for the bit in this section here.</span>
<span class="hljs-comment"># You have to be in this file first to run it.</span>
</code></pre>
<h5 class="code-line" data-line-start=1061 data-line-end=1062><a id="create_tablespy_1061"></a>create_tables.py</h5>
<pre><code class="has-line-data" data-line-start="1064" data-line-end="1080" class="language-python"><span class="hljs-keyword">import</span> sqlite3

connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
cursor = connection.cursor()

create_table = <span class="hljs-string">"CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, username text, password text)"</span>
cursor.execute(create_table)

create_table = <span class="hljs-string">"CREATE TABLE IF NOT EXISTS items (name text, price real)"</span> <span class="hljs-comment"># real is real number</span>
cursor.execute(create_table)

cursor.execute(<span class="hljs-string">"INSERT INTO items values ('test', 10.99)"</span>)

connection.commit()
connection.close()
</code></pre>
<h3 class="code-line" data-line-start=1081 data-line-end=1082><a id="Writing_an_item_1081"></a>Writing an item</h3>
<p class="has-line-data" data-line-start="1083" data-line-end="1084">Because we check the existence of an item first in both POST and GET it is better to have it as its own function</p>
<h5 class="code-line" data-line-start=1085 data-line-end=1086><a id="itempy_1085"></a><a href="http://item.py">item.py</a></h5>
<pre><code class="has-line-data" data-line-start="1088" data-line-end="1165" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resoruce, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = self.find_by_name() <span class="hljs-comment"># You can call it a Item.find_by_name but we called as classmethod so we can do self.find_by_name</span>
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor

    query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
    result = cursor.execute(query, (name,))
    row = result.fetchone()
    connection.close()

    <span class="hljs-keyword">if</span> row:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>:row[<span class="hljs-number">1</span>]}}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> self.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}

    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (item[<span class="hljs-string">'name'</span>], item[<span class="hljs-string">'price'</span>]))
    connection.commit()
    connection.close()

    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-comment">#  global items</span>
    <span class="hljs-comment">#  items = list(filter(lambda x: x['name']==name, items))</span>
    <span class="hljs-comment">#  return {'message': 'item deleted'}</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span> <span class="hljs-comment"># Important to WHERE then specific element</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    item = next(filter(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">'name'</span>] == name, items), <span class="hljs-keyword">None</span>)
    data = parser.parse_args()

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<h3 class="code-line" data-line-start=1166 data-line-end=1167><a id="Refactoring_insertion_of_items_1166"></a>Refactoring insertion of items</h3>
<h5 class="code-line" data-line-start=1169 data-line-end=1170><a id="itempy_1169"></a><a href="http://item.py">item.py</a></h5>
<pre><code class="has-line-data" data-line-start="1172" data-line-end="1264" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resoruce, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = self.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor

    query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
    result = cursor.execute(query, (name,))
    row = result.fetchone()
    connection.close()

    <span class="hljs-keyword">if</span> row:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>:row[<span class="hljs-number">1</span>]}}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> self.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}

<span class="hljs-comment">#  We will remove this to refactor the code</span>
    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "INSERT INTO items VALUES (?, ?)"</span>
    <span class="hljs-comment"># cursor.execute(query, (item['name'], item['price']))</span>
    <span class="hljs-comment"># connection.commit()</span>
    <span class="hljs-comment"># connection.close()</span>

    <span class="hljs-comment"># there is a possibility of error so better try and except</span>
    <span class="hljs-keyword">try</span>:
      self.insert(item)
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>}, <span class="hljs-number">500</span> <span class="hljs-comment"># Internal sever error</span>
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(cls, item)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (item[<span class="hljs-string">'name'</span>], item[<span class="hljs-string">'price'</span>]))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()
    item = self.find_by_name(name)

    updated_item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}
      items.append(item)
    <span class="hljs-keyword">else</span>:
      item.update(data)
    <span class="hljs-keyword">return</span> item

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<h3 class="code-line" data-line-start=1265 data-line-end=1266><a id="The_PUT_Method__Retrieving_Items_1265"></a>The PUT Method &amp; Retrieving Items</h3>
<h5 class="code-line" data-line-start=1268 data-line-end=1269><a id="itempy_1268"></a><a href="http://item.py">item.py</a></h5>
<pre><code class="has-line-data" data-line-start="1271" data-line-end="1365" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resoruce, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = self.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor

    query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
    result = cursor.execute(query, (name,))
    row = result.fetchone()
    connection.close()

    <span class="hljs-keyword">if</span> row:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>:row[<span class="hljs-number">1</span>]}}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> self.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">try</span>:
      self.insert(item)
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(cls, item)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (item[<span class="hljs-string">'name'</span>], item[<span class="hljs-string">'price'</span>]))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = self.find_by_name(name)
    updated_item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-keyword">try</span>:
        self.insert(updated_item)
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred inserting the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">try</span>:  
        self.update(updated_item)
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred updating the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">return</span> updated_item

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(cls, item)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"UPDATE items SET price=? WHERE name=?"</span>
    cursor.execute(query, (item[<span class="hljs-string">'price'</span>], item[<span class="hljs-string">'name'</span>]))

    connection.commit()
    connection.close()
</code></pre>
<h3 class="code-line" data-line-start=1367 data-line-end=1368><a id="Retrieving_Items_1367"></a>Retrieving Items</h3>
<h5 class="code-line" data-line-start=1370 data-line-end=1371><a id="itempy_1370"></a><a href="http://item.py">item.py</a></h5>
<pre><code class="has-line-data" data-line-start="1373" data-line-end="1485" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resoruce, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = self.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor

    query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
    result = cursor.execute(query, (name,))
    row = result.fetchone()
    connection.close()

    <span class="hljs-keyword">if</span> row:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>:row[<span class="hljs-number">1</span>]}}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> self.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">try</span>:
      self.insert(item)
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(cls, item)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (item[<span class="hljs-string">'name'</span>], item[<span class="hljs-string">'price'</span>]))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = self.find_by_name(name)
    updated_item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-keyword">try</span>:
        self.insert(updated_item)
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred inserting the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">try</span>:  
        self.update(updated_item)
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred updating the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">return</span> updated_item

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(cls, item)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"UPDATE items SET price=? WHERE name=?"</span>
    cursor.execute(query, (item[<span class="hljs-string">'price'</span>], item[<span class="hljs-string">'name'</span>]))

    connection.commit()
    connection.close()


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM items"</span>
    result = cursor.execute(query)
    items = []
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> result:
      items.append(
        {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>: row[<span class="hljs-number">1</span>]}
      )

    connection.close()

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<h1 class="code-line" data-line-start=1486 data-line-end=1487><a id="Simplifying_storage_with_FlaskSQLAlchemy_1486"></a>Simplifying storage with Flask-SQLAlchemy</h1>
<h3 class="code-line" data-line-start=1488 data-line-end=1489><a id="Welcome_1488"></a>Welcome</h3>
<p class="has-line-data" data-line-start="1490" data-line-end="1491"><strong>SQL Alchemy</strong> is used to <em>easily</em> store objects to relational database.</p>
<h3 class="code-line" data-line-start=1492 data-line-end=1493><a id="Setup_1492"></a>Setup</h3>
<p class="has-line-data" data-line-start="1494" data-line-end="1495">SQLAlchemy allows us to Map our object to database rows.</p>
<pre><code class="has-line-data" data-line-start="1497" data-line-end="1504" class="language-bash">virtualenv venv --python=python3.<span class="hljs-number">5</span> <span class="hljs-comment"># venv is the name of the virtual environment</span>
./venv/Scripts/activate.bat
pip install flask
pip install Flask-JWT
pip install Flask-RESTful
pip install Flask-SQLAlchemy
</code></pre>
<h3 class="code-line" data-line-start=1505 data-line-end=1506><a id="Improving_the_Project_Structure_and_Maintainability_1505"></a>Improving the Project Structure and Maintainability</h3>
<p class="has-line-data" data-line-start="1507" data-line-end="1508">Create these folders -</p>
<ul>
<li class="has-line-data" data-line-start="1508" data-line-end="1509">Models</li>
<li class="has-line-data" data-line-start="1509" data-line-end="1511">Resources</li>
</ul>
<p class="has-line-data" data-line-start="1511" data-line-end="1512">To convert these folders into <em>Python Packages</em> include a <code>__init__.py</code> script in to the directory.</p>
<p class="has-line-data" data-line-start="1513" data-line-end="1514"><code>item.py</code> and <code>user.py</code> both uses <em>Resource</em> and we should move these scripts to the Resources directory/package.</p>
<h5 class="code-line" data-line-start=1515 data-line-end=1516><a id="apppy_1515"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="1519" data-line-end="1541" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-comment"># from user import UserRegister</span>
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-comment">#from item import Item, ItemList</span>
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList

app = Flask(__name__)
app.secret_key = <span class="hljs-string">'use a secret key here'</span>
api = Api(app)

jwt = JWT(app, authenticate, identity)

api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>) <span class="hljs-comment"># Registering user signup in; /auth != /register</span>

app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)
</code></pre>
<h5 class="code-line" data-line-start=1542 data-line-end=1543><a id="securitypy_1542"></a><a href="http://security.py">security.py</a></h5>
<pre><code class="has-line-data" data-line-start="1545" data-line-end="1559" class="language-python">
<span class="hljs-keyword">from</span> werkzeug.security <span class="hljs-keyword">import</span> safe_str_cmp
<span class="hljs-comment"># from user import User</span>
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> User

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate</span><span class="hljs-params">(username, password)</span>:</span>
  user = User.find_by_username(username)
  <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> safe_str_cmp(user.password, password)
    <span class="hljs-keyword">return</span> user

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">identity</span><span class="hljs-params">(payload)</span>:</span>
  user_id = payload[<span class="hljs-string">'identity'</span>]
  <span class="hljs-keyword">return</span> User.find_by_id(user_id)
</code></pre>
<h3 class="code-line" data-line-start=1560 data-line-end=1561><a id="Creating_user_and_item_model_1560"></a>Creating user and item model</h3>
<p class="has-line-data" data-line-start="1562" data-line-end="1563">Current file directory</p>
<pre><code class="has-line-data" data-line-start="1565" data-line-end="1575">models
- __init__.py
resources
- __init__.py
- item.py
- user.py
app.py
create_tables.py
security.py
</code></pre>
<p class="has-line-data" data-line-start="1576" data-line-end="1577">In the resources directory/packages, the <code>item.py</code> file contains two classes. <code>Item</code> and <code>ItemList</code>. And they are both resources. In the same directory, the <code>user.py</code> file contains two classes. <code>User</code> and <code>UserRegister</code>. Here only the <code>UserRegister</code> is the only resource class.</p>
<p class="has-line-data" data-line-start="1578" data-line-end="1579">Now we need to remove the <code>User</code> class from the resource directory as it does not make logical sense to have it in the resource directory. We are going to cut that out and create a new file in the models folder called <code>user.py</code> and paste it there.</p>
<p class="has-line-data" data-line-start="1580" data-line-end="1581"><strong>What is a model is?</strong> Resources are something that API responds with and API clients can ask for. Resources is everything the API deals with. The class user in models/user.py isnt something that the API can send or receive or cant convert to a JSON representation. This is a <em>helper</em>. A model our internal representation of the entity. A resource is the external representation of the entity. Models help us with extended flexibility with resources with making the resource file more complicated.</p>
<h5 class="code-line" data-line-start=1582 data-line-end=1583><a id="modelsuserpy_1582"></a>models/user.py</h5>
<pre><code class="has-line-data" data-line-start="1585" data-line-end="1626" class="language-python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-comment"># class User:</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserModel</span>:</span>
<span class="hljs-comment"># Because model and resources are different and we need to make it different.</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id
    self.username = username
    self.password = password

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(cls, username)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM users WHERE username=?"</span>
    result = cursor.execute(query, (username))
    row = result.fetchone()
    
    <span class="hljs-keyword">if</span> row:
      user = cls(*row)
    <span class="hljs-keyword">else</span>:
      user = <span class="hljs-keyword">None</span>

<span class="hljs-decorator">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_id</span><span class="hljs-params">(cls, _id)</span>:</span>
      connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
      cursor = connection.cursor()

      query = <span class="hljs-string">"SELECT * FROM users WHERE id=?"</span>
      result = cursor.execute(query, (_id))
      row = result.fetchone()

      <span class="hljs-keyword">if</span> row:
        user = cls(*row)
      <span class="hljs-keyword">else</span>:
        user = <span class="hljs-keyword">None</span>

      connection.close()
      <span class="hljs-keyword">return</span> user
</code></pre>
<h5 class="code-line" data-line-start=1627 data-line-end=1628><a id="resourcesuserpy_1627"></a>resources/user.py</h5>
<pre><code class="has-line-data" data-line-start="1630" data-line-end="1667" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">import</span> models.user <span class="hljs-keyword">import</span> UserModel
<span class="hljs-comment"># We are importing this as we have created a new file</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegister</span><span class="hljs-params">(Resource)</span>:</span>
  parser = reqparse.RequestParser()
  parser.add_argument(<span class="hljs-string">'username'</span>,
    type=str,
    required=<span class="hljs-keyword">True</span>
    help=<span class="hljs-string">"This field cannot be blank"</span>
  )
  parser.add_argument(<span class="hljs-string">'password'</span>,
    tyep=str,
    required=<span class="hljs-keyword">True</span>,
    help=<span class="hljs-string">"This field cannon be blank"</span>
  )

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self)</span>:</span>
    data = UserRegister.parser.parse_args()

    <span class="hljs-comment"># if User.find_by_username(data['username']):</span>
    <span class="hljs-comment"># Class name was changed</span>
    <span class="hljs-keyword">if</span> UserModel.find_by_username(data[<span class="hljs-string">'username'</span>]):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"A user with that username already exists"</span>}, <span class="hljs-number">400</span>
    
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO users VALUES (NULL, ?, ?)"</span>
    cursor.execute(query, (data[<span class="hljs-string">'username'</span>], data[<span class="hljs-string">'password'</span>]))

    connection.commit()
    connection.close()
    
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'User created successfully'</span>}, <span class="hljs-number">201</span>
</code></pre>
<h5 class="code-line" data-line-start=1669 data-line-end=1670><a id="securitypy_1669"></a><a href="http://security.py">security.py</a></h5>
<pre><code class="has-line-data" data-line-start="1672" data-line-end="1687" class="language-python"><span class="hljs-keyword">from</span> werkzeug.security <span class="hljs-keyword">import</span> safe_str_cmp
<span class="hljs-comment"># from resources.user import User</span>
<span class="hljs-comment">#  We created a separate file from this</span>
<span class="hljs-keyword">from</span> models.user <span class="hljs-keyword">import</span> UserModel


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate</span><span class="hljs-params">(username, password)</span>:</span>
  user = UserModel.find_by_username(username) <span class="hljs-comment">#this was changed</span>
  <span class="hljs-keyword">if</span> user <span class="hljs-keyword">and</span> safe_str_cmp(userp.password, password):
    <span class="hljs-keyword">return</span> user

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">identity</span><span class="hljs-params">(payload)</span>:</span>
  user_id =  payload[<span class="hljs-string">'identity'</span>]
  <span class="hljs-keyword">return</span> UserModel.find_by_id(user_id) <span class="hljs-comment">#this was changed</span>
</code></pre>
<p class="has-line-data" data-line-start="1688" data-line-end="1689">Now we are going to separate the item part from resources to models. But we dont have an <code>item</code> mode so we are going to create one from scratch. Now, from the <code>resources/item.py</code> we have to figure out what things that can be done in the <code>models/item.py</code> to make that file less complicated. Resource should only deal with <em>request verbs</em> but additional functionalities through methods should be carried by the models file.</p>
<p class="has-line-data" data-line-start="1690" data-line-end="1691">So we are taking out <code>find_by_name_method</code>, <code>insert</code> method as they are not called by the API directly.</p>
<h5 class="code-line" data-line-start=1692 data-line-end=1693><a id="modelsitempy_1692"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="1695" data-line-end="1745" class="language-python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span>:</span>
<span class="hljs-comment"># as it is an internal representation it should contain object properties</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}
    <span class="hljs-comment"># dictionary representing our item</span>

  <span class="hljs-comment"># from resource/item to model/item</span>
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
   connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
   cursor = connection.cursor()

   query = <span class="hljs-string">"SELECT * FROM WHERE name=?"</span>
   result = cursor.execute(query, (name))
   row = result.fetchone()
   connection.close()

   <span class="hljs-keyword">if</span> row:
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'item'</span>: {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>: row[<span class="hljs-number">1</span>]}}
  
<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(cls, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (item[<span class="hljs-string">'name'</span>], item[<span class="hljs-string">'price'</span>]))

    connection.commit()
    connection.close()

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(cls, item)</span>:</span>
  <span class="hljs-comment"># Yes this is a model</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()
    
    query = <span class="hljs-string">"UPDATE items SET price=? WHERE name=?"</span>
    cursor.execute(query, (item[<span class="hljs-string">'price'</span>], item[<span class="hljs-string">'name'</span>]))

    connection.commit()
    connection.close()

</code></pre>
<p class="has-line-data" data-line-start="1746" data-line-end="1747">Tip: Methods within a class should be separated by one line; classes by two lines.</p>
<h5 class="code-line" data-line-start=1749 data-line-end=1750><a id="resourceitempy_1749"></a>resource/item.py</h5>
<pre><code class="has-line-data" data-line-start="1752" data-line-end="1832" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> models.item <span class="hljs-keyword">import</span> ItemModel <span class="hljs-comment"># Importing the new ItemModel Class</span>

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = ItemModel.find_by_name() <span class="hljs-comment"># This line was changed from self &gt; ItemModel</span>
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-comment"># if self.find_by_name(name):</span>
    <span class="hljs-keyword">if</span> ItemModel.find_by_name(name): <span class="hljs-comment">#This line was changed</span>
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = {<span class="hljs-string">'name'</span>: name, <span class="hljs-string">'price'</span>: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">try</span>:
      ItemModel.insert(item) <span class="hljs-comment"># Changed</span>
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item, <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = ItemModel.find_by_name(name) <span class="hljs-comment">#changed</span>
    updated_item = {<span class="hljs-string">'name'</span>: name, price: data[<span class="hljs-string">'price'</span>]}

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-keyword">try</span>:
        ItemModel.insert(updated_item) <span class="hljs-comment">#changed</span>
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred inserting the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">try</span>:  
        ItemModel.update(updated_item) <span class="hljs-comment">#changed</span>
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred updating the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">return</span> updated_item


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM items"</span>
    result = cursor.execute(query)
    items = []
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> result:
      items.append(
        {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>: row[<span class="hljs-number">1</span>]}
      )

    connection.close()

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<p class="has-line-data" data-line-start="1833" data-line-end="1834">Bear with me as this a bit a complicated.</p>
<p class="has-line-data" data-line-start="1835" data-line-end="1836">The <code>ItemModel</code> IS the item that we are dealing with. Now, <strong>CLS or classmethod is used when inside the class the class itself is being referenced.</strong></p>
<p class="has-line-data" data-line-start="1837" data-line-end="1838">Now if we are dealing with the Item itself in <em>insert</em> or <em>update</em> the <code>classmethod</code> does not make sense. We are initing the class with objects of price and name in the ItemModel. These two models are inserting itself and a class method doesnt make any sense.</p>
<p class="has-line-data" data-line-start="1839" data-line-end="1840">We are going to change <code>ItemModel.insert(updated_item)</code> to simply <code>updated_item.insert</code> because the ItemModel was already inited with the item and it is not necessary to do a double with a <code>classmethod</code>.</p>
<h5 class="code-line" data-line-start=1842 data-line-end=1843><a id="modelsitempy_1842"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="1845" data-line-end="1901" class="language-python"><span class="hljs-keyword">import</span> sqlite3

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
  <span class="hljs-comment"># As this returns an object rather than a dictionary we are going to need classmethod</span>
  <span class="hljs-comment"># We need to return object model instead a dictionary</span>
   connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
   cursor = connection.cursor()

   query = <span class="hljs-string">"SELECT * FROM WHERE name=?"</span>
   result = cursor.execute(query, (name))
   row = result.fetchone()
   connection.close()

   <span class="hljs-keyword">if</span> row:
    <span class="hljs-comment"># return {'item': {'name': row[0], 'price': row[1]}}</span>
    <span class="hljs-comment"># We need to return object model instead a dictionary</span>
    <span class="hljs-keyword">return</span> cls(*row)
    <span class="hljs-comment"># This is essentially this return cls(row[0], row[1])</span>
    <span class="hljs-comment"># Argument unpacking</span>
    <span class="hljs-comment"># cls calls the ItemModels init method</span>
    <span class="hljs-comment"># row[0] = name. row[1] = price</span>
  
  <span class="hljs-comment"># @classmethod</span>
  <span class="hljs-comment"># def insert(cls, name):</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    <span class="hljs-comment"># cursor.execute(query, (item['name'], item['price']))</span>
    cursor.execute(query, (self.name, self.price))

    connection.commit()
    connection.close()

  <span class="hljs-comment"># @classmethod</span>
  <span class="hljs-comment"># def update(cls, item):</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()
    
    query = <span class="hljs-string">"UPDATE items SET price=? WHERE name=?"</span>
    cursor.execute(query, (self.name, self.price))

    connection.commit()
    connection.close()

</code></pre>
<h5 class="code-line" data-line-start=1902 data-line-end=1903><a id="resourceitempy_1902"></a>resource/item.py</h5>
<pre><code class="has-line-data" data-line-start="1905" data-line-end="1999" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> models.item <span class="hljs-keyword">import</span> ItemModel

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = ItemModel.find_by_name()
    <span class="hljs-comment"># This now returns an Item object rather than a dictionary</span>
    <span class="hljs-keyword">if</span> item:
    <span class="hljs-comment"># Now cannot return an item directly as this is not a dictionary/json</span>
    <span class="hljs-comment"># We have a method on ItemModel specifically for this called 'json'</span>
      <span class="hljs-comment"># return item</span>
      <span class="hljs-keyword">return</span> item.json()
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> ItemModel.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    <span class="hljs-comment"># item = {'name': name, 'price': data['price']}</span>
    <span class="hljs-comment"># Now it is an item model</span>
    item = ItemModel(name, data[<span class="hljs-string">'price'</span>])

    <span class="hljs-keyword">try</span>:
      <span class="hljs-comment"># ItemModel.insert(item)</span>
      <span class="hljs-comment"># We can insert the item model</span>
      item.insert()
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item.json(), <span class="hljs-number">201</span> <span class="hljs-comment">#changed</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"DELETE FROM items WHERE name=?"</span>
    cursor.execute(query, (name,))
    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = ItemModel.find_by_name(name)
    <span class="hljs-comment"># This is an item object</span>
    <span class="hljs-comment"># updated_item = {'name': name, price: data['price']}</span>
    <span class="hljs-comment"># ^ This is an item dictionary</span>
    <span class="hljs-comment"># We convert this to item model</span>
    updated_item = ItemModel(name, data[<span class="hljs-string">'price'</span>])

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-keyword">try</span>:
        <span class="hljs-comment"># ItemModel.insert(updated_item)</span>
        updated_item.insert()
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred inserting the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-keyword">else</span>:
      <span class="hljs-keyword">try</span>:  
        <span class="hljs-comment"># ItemModel.update(updated_item)</span>
        updated_item.update()
      <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"An error ocurred updating the item."</span>}, <span class="hljs-number">500</span>
    <span class="hljs-comment"># return updated_item</span>
    <span class="hljs-keyword">return</span> updated_item.json()


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM items"</span>
    result = cursor.execute(query)
    items = []
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> result:
      items.append(
        {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>: row[<span class="hljs-number">1</span>]}
      )

    connection.close()

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<h3 class="code-line" data-line-start=2000 data-line-end=2001><a id="Advanced_Postman_Environments_2000"></a>Advanced Postman Environments</h3>
<p class="has-line-data" data-line-start="2002" data-line-end="2003"><strong>Setting Variables</strong></p>
<pre><code class="has-line-data" data-line-start="2005" data-line-end="2007">{{url}}/items
</code></pre>
<p class="has-line-data" data-line-start="2007" data-line-end="2008">Gear logo &gt; Manage Environments &gt; Add Environment</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>127.0.0.1/5000</td>
</tr>
</tbody>
</table>
<p class="has-line-data" data-line-start="2014" data-line-end="2015">Then remember to save.</p>
<p class="has-line-data" data-line-start="2016" data-line-end="2017"><strong>Handling the JWT token</strong></p>
<p class="has-line-data" data-line-start="2018" data-line-end="2019">Headers &gt; Authorization &gt; <code>JWT {{jwt_token}}</code></p>
<p class="has-line-data" data-line-start="2020" data-line-end="2021">In the endpoint select the Tests tab.</p>
<pre><code class="has-line-data" data-line-start="2023" data-line-end="2025" class="language-javascript"><span class="hljs-keyword">var</span> jsonData = <span class="hljs-built_in">JSON</span>.parse(responseBody);
</code></pre>
<p class="has-line-data" data-line-start="2026" data-line-end="2027">You can get more of these codes in the snippets section. Add -</p>
<pre><code class="has-line-data" data-line-start="2029" data-line-end="2031" class="language-javascript">tests[<span class="hljs-string">'access_token_test'</span>] = jsonData.access_token !=== <span class="hljs-literal">undefined</span>;
</code></pre>
<p class="has-line-data" data-line-start="2032" data-line-end="2033">Returns a Boolean value for checking if the response code exists or not. Add -</p>
<pre><code class="has-line-data" data-line-start="2035" data-line-end="2037" class="language-javascript">postman.setEnvironmentVariable(<span class="hljs-string">"jwt_token"</span>, jsonData.access_token)
</code></pre>
<p class="has-line-data" data-line-start="2038" data-line-end="2039">Saves JWT token as environmental variable.</p>
<p class="has-line-data" data-line-start="2040" data-line-end="2041">Send the request and you will see that your test passed and you even which ones passed.</p>
<p class="has-line-data" data-line-start="2042" data-line-end="2043">If you click the eye logo on top you can see your environmental variables there.</p>
<p class="has-line-data" data-line-start="2044" data-line-end="2045">Explore the snippet column on the tests section.</p>
<h3 class="code-line" data-line-start=2046 data-line-end=2047><a id="Telling_SQLAlchemy_about_our_tables_2046"></a>Telling SQLAlchemy about our tables</h3>
<p class="has-line-data" data-line-start="2048" data-line-end="2049">Create a newfile in the basecode folder called <code>db.py</code>.</p>
<h5 class="code-line" data-line-start=2050 data-line-end=2051><a id="dbpy_2050"></a><a href="http://db.py">db.py</a></h5>
<pre><code class="has-line-data" data-line-start="2053" data-line-end="2060" class="language-python"><span class="hljs-keyword">from</span> flask_sqlalchemy <span class="hljs-keyword">import</span> SQLAlchemy

db = SQLAlchamey()
<span class="hljs-comment"># This object is going to link to the app.py</span>
<span class="hljs-comment"># then look into all the onjects we tell it to</span>
<span class="hljs-comment"># them map those objects in to rows of a database</span>
</code></pre>
<h5 class="code-line" data-line-start=2061 data-line-end=2062><a id="apppy_2061"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="2064" data-line-end="2090" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList

app = Flask(__name__)
app.secret_key = <span class="hljs-string">"secret_key"</span>
api = Api(app)

jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>
api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>)

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">"__main__"</span>:
  <span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db <span class="hljs-comment">#Changed</span>
  <span class="hljs-comment"># circular imports</span>
  <span class="hljs-comment"># We are going to import the db in other modules</span>
  <span class="hljs-comment"># so this will import db once more if we put it in the top</span>
  db.init_app(app)
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)

</code></pre>
<h5 class="code-line" data-line-start=2091 data-line-end=2092><a id="modelsuserpy_2091"></a>models/user.py</h5>
<pre><code class="has-line-data" data-line-start="2094" data-line-end="2154" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserModel</span><span class="hljs-params">(db.Model)</span>:</span> <span class="hljs-comment">#changed</span>
  <span class="hljs-comment"># This db.model tell SQLAlchemy that we will be</span>
  <span class="hljs-comment"># interacting with this class/ item models/ objects in the database</span>
  <span class="hljs-comment"># This creates a 'mapping' between objects and the database</span>

  __tablename__ = <span class="hljs-string">'users'</span>

  <span class="hljs-comment"># This 'users' is the table row we are accessing in the db</span>
  <span class="hljs-comment"># The columns we will be accessing &gt;</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  <span class="hljs-comment"># primary_key&gt; unique indexable variable</span>
  username = db.Column(db.String(<span class="hljs-number">80</span>))
  <span class="hljs-comment"># Limits the username string size</span>
  password = db.Column(db.String(<span class="hljs-number">80</span>))
  <span class="hljs-comment"># This variables must be identical to the init variable</span>
  <span class="hljs-comment"># Anything that is not declared here won't be communicated with the db</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, _id, username, password)</span>:</span>
    self.id = _id
    self.username = username
    self.password = password

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(cls, username)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM users WHERE username=?"</span>
    result = cursor.execute(query, (username))
    row = result.fetchone()
    
    <span class="hljs-keyword">if</span> row:
      user = cls(*row)
    <span class="hljs-keyword">else</span>:
      user = <span class="hljs-keyword">None</span>
    
    connection.close()
    <span class="hljs-keyword">return</span> user

<span class="hljs-decorator">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_id</span><span class="hljs-params">(cls, _id)</span>:</span>
      connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
      cursor = connection.cursor()

      query = <span class="hljs-string">"SELECT * FROM users WHERE id=?"</span>
      result = cursor.execute(query, (_id))
      row = result.fetchone()

      <span class="hljs-keyword">if</span> row:
        user = cls(*row)
      <span class="hljs-keyword">else</span>:
        user = <span class="hljs-keyword">None</span>

      connection.close()
      <span class="hljs-keyword">return</span> user
</code></pre>
<h5 class="code-line" data-line-start=2155 data-line-end=2156><a id="modelsitempy_2155"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="2158" data-line-end="2210" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db <span class="hljs-comment">#changed</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span><span class="hljs-params">(db.Model)</span>:</span> <span class="hljs-comment">#changed</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  <span class="hljs-comment"># Even though we didn't have an id, we are going to create one anyway</span>
  <span class="hljs-comment"># it is very useful</span>
  name = db.Column(db.String(<span class="hljs-number">80</span>))
  price = db.Column(db.Float(precision=<span class="hljs-number">2</span>))

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
   connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
   cursor = connection.cursor()

   query = <span class="hljs-string">"SELECT * FROM items WHERE name=?"</span>
   result = cursor.execute(query, (name))
   row = result.fetchone()
   connection.close()

   <span class="hljs-keyword">if</span> row:
    <span class="hljs-keyword">return</span> cls(*row)
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">insert</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"INSERT INTO items VALUES (?, ?)"</span>
    cursor.execute(query, (self.name, self.price))

    connection.commit()
    connection.close()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()
    
    query = <span class="hljs-string">"UPDATE items SET price=? WHERE name=?"</span>
    cursor.execute(query, (self.name, self.price))

    connection.commit()
    connection.close()

</code></pre>
<h5 class="code-line" data-line-start=2211 data-line-end=2212><a id="apppy_2211"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="2214" data-line-end="2242" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList

app = Flask(__name__)

app.config[<span class="hljs-string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="hljs-keyword">False</span>
<span class="hljs-comment"># We are just disabling the resource intensive tracking of changes to objects</span>
<span class="hljs-comment"># This is a Flask tracker not the SQLAlchemy Tracker</span>

app.secret_key = <span class="hljs-string">"secret_key"</span>
api = Api(app)

jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>
api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>)

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">"__main__"</span>:
  <span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db
  db.init_app(app)
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)

</code></pre>
<h3 class="code-line" data-line-start=2243 data-line-end=2244><a id="Implementing_ItemModel_2243"></a>Implementing ItemModel</h3>
<h5 class="code-line" data-line-start=2245 data-line-end=2246><a id="create_tablespy_2245"></a>create_tables.py</h5>
<pre><code class="has-line-data" data-line-start="2248" data-line-end="2263" class="language-python"><span class="hljs-keyword">import</span> sqlite3

connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
cursor = connection.cursor()

create_table = <span class="hljs-string">"CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY, username text, password text)"</span>
cursor.execute(create_table)

<span class="hljs-comment"># create_table = "CREATE TABLE IF NOT EXISTS items (name text, price text)"</span>
create_table = <span class="hljs-string">"CREATE TABLE IF NOT EXISTS items (id INTEGER PRIMARY KEY, name text, price text)"</span>
cursor.execute(create_table)

connection.commit()
connection.close()
</code></pre>
<p class="has-line-data" data-line-start="2264" data-line-end="2265">We need to run this file and create the db first. We need to have the db in the root directory.</p>
<h5 class="code-line" data-line-start=2266 data-line-end=2267><a id="modelsitempy_2266"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="2269" data-line-end="2357" class="language-python"><span class="hljs-comment"># import sqlite3</span>
<span class="hljs-comment"># Not needed anymore</span>
<span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  name = db.Column(db.String(<span class="hljs-number">80</span>))
  price = db.Column(db.Float(precision=<span class="hljs-number">2</span>))

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
  <span class="hljs-comment"># SQLAlchemy automatically converts the SQL row to an object</span>

  <span class="hljs-comment">#  connection = sqlite3.connect('data.db')</span>
  <span class="hljs-comment">#  cursor = connection.cursor()</span>

  <span class="hljs-comment">#  query = "SELECT * FROM items WHERE name=?"</span>
  <span class="hljs-comment">#  result = cursor.execute(query, (name))</span>
  <span class="hljs-comment">#  row = result.fetchone()</span>
  <span class="hljs-comment">#  connection.close()</span>

  <span class="hljs-comment">#  if row:</span>
  <span class="hljs-comment">#   return cls(*row)</span>
  <span class="hljs-keyword">return</span> cls.query.filter_by(name=name).first() <span class="hljs-comment"># SELECT * FROM items WHERE name=name LIMIT 1</span>
  <span class="hljs-comment"># This '.query' comes from db.model that the ItemModel is taking as an argument.</span>
  <span class="hljs-comment"># This is an 'query builder' and we can build queries with this</span>
  <span class="hljs-comment"># 'filter_by' is query builder also which returns objects but we only need the first one</span>
  <span class="hljs-comment"># filter_by(name=name) # SELECT * FROM items WHERE name=name</span>
  <span class="hljs-comment"># We can chain `filter_by' functions together like-</span>
  <span class="hljs-comment"># filter_by(name=name).filter_by(id=1)</span>
  <span class="hljs-comment"># Or it can take multiple arguments rather than chaining</span>
  <span class="hljs-comment"># filter_by(name=name, id=1)</span>
  <span class="hljs-comment"># This is returning an ItemModel object</span>
  <span class="hljs-comment"># that means this is "inited" by the classmodel and it has self.name and self.price</span>
  <span class="hljs-comment"># return ItemModel.something is the same as cls.something but the thing it returns also gets passed through init</span>


  
  <span class="hljs-comment"># def insert(self):</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
  <span class="hljs-comment"># This is just saving the ItemModel to the database</span>
  <span class="hljs-comment"># SQLAlchemy can directly translate class object to database row</span>
  <span class="hljs-comment"># We don't need to define what row data to insert (self.name, self.price)</span>
  <span class="hljs-comment"># Just directly insert them into the db</span>
  <span class="hljs-comment"># The object we are dealing with is "self"</span>

    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "INSERT INTO items VALUES (?, ?)"</span>
    <span class="hljs-comment"># cursor.execute(query, (self.name, self.price))</span>

    <span class="hljs-comment"># connection.commit()</span>
    <span class="hljs-comment"># connection.close()</span>
    db.session.add(self)
    db.session.commit()
    <span class="hljs-comment"># session is a collection object we are going to write to the database</span>
    <span class="hljs-comment"># data &gt; ItemModel &gt; self/db.Model &gt; init &gt; (self.price, self.name) &gt; session.add(self) &gt; session.commit()</span>
    <span class="hljs-comment"># because of the unique primary ID this code can also update</span>
    <span class="hljs-comment"># that is why we changed the name</span>
    <span class="hljs-comment"># update + insert = upserting</span>

  <span class="hljs-comment"># Upserting makes this section redundant</span>
  <span class="hljs-comment"># def update(self):</span>
  <span class="hljs-comment">#   connection = sqlite3.connect('data.db')</span>
  <span class="hljs-comment">#   cursor = connection.cursor()</span>
    
  <span class="hljs-comment">#   query = "UPDATE items SET price=? WHERE name=?"</span>
  <span class="hljs-comment">#   cursor.execute(query, (self.name, self.price))</span>

  <span class="hljs-comment">#   connection.commit()</span>
  <span class="hljs-comment">#   connection.close()</span>

  <span class="hljs-comment"># New Stuff</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.delete(self)
    db.session.commit()

</code></pre>
<h5 class="code-line" data-line-start=2358 data-line-end=2359><a id="modelsitempy_2358"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="2361" data-line-end="2390" class="language-python"><span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  name = db.Column(db.String(<span class="hljs-number">80</span>))
  price = db.Column(db.Float(precision=<span class="hljs-number">2</span>))

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    <span class="hljs-keyword">return</span> cls.query.filter_by(name=name).first() <span class="hljs-comment"># SELECT * FROM items WHERE name=name LIMIT 1</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.add(self)
    db.session.commit()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.delete(self)
    db.session.commit()

</code></pre>
<h5 class="code-line" data-line-start=2391 data-line-end=2392><a id="resourceitempy_2391"></a>resource/item.py</h5>
<pre><code class="has-line-data" data-line-start="2394" data-line-end="2488" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> models.item <span class="hljs-keyword">import</span> ItemModel

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = ItemModel.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item.json()
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> ItemModel.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = ItemModel(name, data[<span class="hljs-string">'price'</span>])

    <span class="hljs-keyword">try</span>:
      <span class="hljs-comment"># item.insert()</span>
      item.save_to_db()
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item.json(), <span class="hljs-number">201</span> 

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
  <span class="hljs-comment"># We are going to use the model to do the deletion</span>
    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "DELETE FROM items WHERE name=?"</span>
    <span class="hljs-comment"># cursor.execute(query, (name,))</span>
    <span class="hljs-comment"># connection.commit()</span>
    <span class="hljs-comment"># connection.close()</span>
  item = ItemModel.find_by_name(name)
  <span class="hljs-keyword">if</span> item:
    item.delete_from_db()
  <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Item Deleted"</span>}


  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = ItemModel.find_by_name(name)
    <span class="hljs-comment"># updated_item = ItemModel(name, data['price'])</span>

    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-comment"># try:</span>
      <span class="hljs-comment">#   updated_item.insert()</span>
      <span class="hljs-comment"># except:</span>
      <span class="hljs-comment">#   return {"message": "An error ocurred inserting the item."}, 500</span>
      item = ItemModel(name, data[<span class="hljs-string">'price'</span>])
      <span class="hljs-comment"># we are creating a new item through the ItemModel class &gt; db.model</span>
    <span class="hljs-keyword">else</span>:
      <span class="hljs-comment"># try:  </span>
      <span class="hljs-comment">#   updated_item.update()</span>
      <span class="hljs-comment"># except:</span>
      <span class="hljs-comment">#   return {"message": "An error ocurred updating the item."}, 500</span>
      item.price = data[<span class="hljs-string">'price'</span>]
    
    item.save_to_db()
    <span class="hljs-comment"># Because the item is now uniquely identified by db</span>
    <span class="hljs-comment"># all we have to do is save to db</span>
    <span class="hljs-comment"># return updated_item.json()</span>
    <span class="hljs-keyword">return</span> item.json()


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    connection = sqlite3.connect(<span class="hljs-string">'data.db'</span>)
    cursor = connection.cursor()

    query = <span class="hljs-string">"SELECT * FROM items"</span>
    result = cursor.execute(query)
    items = []
    <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> result:
      items.append(
        {<span class="hljs-string">'name'</span>: row[<span class="hljs-number">0</span>], <span class="hljs-string">'price'</span>: row[<span class="hljs-number">1</span>]}
      )

    connection.close()

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: items}
</code></pre>
<p class="has-line-data" data-line-start="2489" data-line-end="2490">Now we are going to tell flask where to find the <code>data.db</code> file.</p>
<h5 class="code-line" data-line-start=2491 data-line-end=2492><a id="apppy_2491"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="2494" data-line-end="2521" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList

app = Flask(__name__)

app.config[<span class="hljs-string">'SQLALCHEMY_DATABSE_URI'</span>] = <span class="hljs-string">'sqlite:///data.db'</span>
app.config[<span class="hljs-string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="hljs-keyword">False</span>

app.secret_key = <span class="hljs-string">"secret_key"</span>
api = Api(app)

jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>
api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>)

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">"__main__"</span>:
  <span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db
  db.init_app(app)
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)

</code></pre>
<h3 class="code-line" data-line-start=2522 data-line-end=2523><a id="Implementing_the_UserModel_2522"></a>Implementing the UserModel</h3>
<pre><code class="has-line-data" data-line-start="2525" data-line-end="2588" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'users'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  username = db.Column(db.String(<span class="hljs-number">80</span>))
  password = db.Column(db.String(<span class="hljs-number">80</span>))

  <span class="hljs-comment"># def __init__(self, _id, username, password):</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, username, password)</span>:</span>
    <span class="hljs-comment"># self.id = _id</span>
    <span class="hljs-comment"># This id is automatically assigned</span>
    <span class="hljs-comment"># if we didn't autoincrement we could have used an id</span>
    <span class="hljs-comment"># We can also UUID</span>
    self.username = username
    self.password = password

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_username</span><span class="hljs-params">(cls, username)</span>:</span>
    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "SELECT * FROM users WHERE username=?"</span>
    <span class="hljs-comment"># result = cursor.execute(query, (username))</span>
    <span class="hljs-comment"># row = result.fetchone()</span>
    
    <span class="hljs-comment"># if row:</span>
    <span class="hljs-comment">#   user = cls(*row)</span>
    <span class="hljs-comment"># else:</span>
    <span class="hljs-comment">#   user = None</span>

    <span class="hljs-comment"># connection.close()</span>
    <span class="hljs-comment"># return user</span>
    <span class="hljs-keyword">return</span> cls.query.filter_by(username=username).first()

<span class="hljs-decorator">    @classmethod</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_id</span><span class="hljs-params">(cls, _id)</span>:</span>
      <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
      <span class="hljs-comment"># cursor = connection.cursor()</span>

      <span class="hljs-comment"># query = "SELECT * FROM users WHERE id=?"</span>
      <span class="hljs-comment"># result = cursor.execute(query, (_id))</span>
      <span class="hljs-comment"># row = result.fetchone()</span>

      <span class="hljs-comment"># if row:</span>
      <span class="hljs-comment">#   user = cls(*row)</span>
      <span class="hljs-comment"># else:</span>
      <span class="hljs-comment">#   user = None</span>

      <span class="hljs-comment"># connection.close()</span>
      <span class="hljs-comment"># return user</span>
      <span class="hljs-keyword">return</span> cls.query.filter_by(id=_id).first()

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
      db.session.add(self)
      db.session.commit()
    
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
      db.session.delete(self)
      db.session.commit()
</code></pre>
<h5 class="code-line" data-line-start=2589 data-line-end=2590><a id="resourcesuserpy_2589"></a>resources/user.py</h5>
<pre><code class="has-line-data" data-line-start="2592" data-line-end="2632" class="language-python"><span class="hljs-keyword">import</span> sqlite3
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">import</span> models.user <span class="hljs-keyword">import</span> UserModel

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegister</span><span class="hljs-params">(Resource)</span>:</span>
  parser = reqparse.RequestParser()
  parser.add_argument(<span class="hljs-string">'username'</span>,
    type=str,
    required=<span class="hljs-keyword">True</span>
    help=<span class="hljs-string">"This field cannot be blank"</span>
  )
  parser.add_argument(<span class="hljs-string">'password'</span>,
    tyep=str,
    required=<span class="hljs-keyword">True</span>,
    help=<span class="hljs-string">"This field cannon be blank"</span>
  )

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self)</span>:</span>
    data = UserRegister.parser.parse_args()

    <span class="hljs-keyword">if</span> UserModel.find_by_username(data[<span class="hljs-string">'username'</span>]):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"A user with that username already exists"</span>}, <span class="hljs-number">400</span>
    
    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "INSERT INTO users VALUES (NULL, ?, ?)"</span>
    <span class="hljs-comment"># cursor.execute(query, (data['username'], data['password']))</span>

    <span class="hljs-comment"># connection.commit()</span>
    <span class="hljs-comment"># connection.close()</span>
    
    user = UserModel(**data)
    <span class="hljs-comment"># This is exactly this</span>
    <span class="hljs-comment"># user = UserModel(data['username'], data['password'])</span>
    <span class="hljs-comment"># ** unpacks the values</span>
    user.save_to_db()
    
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'User created successfully'</span>}, <span class="hljs-number">201</span>
</code></pre>
<h3 class="code-line" data-line-start=2633 data-line-end=2634><a id="Displaying_Items_from_ItemList_Resources_2633"></a>Displaying Items from ItemList Resources</h3>
<h5 class="code-line" data-line-start=2635 data-line-end=2636><a id="resourcesitempy_2635"></a>resources/item.py</h5>
<pre><code class="has-line-data" data-line-start="2638" data-line-end="2712" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-comment"># import sqlite3</span>
<span class="hljs-keyword">from</span> models.item <span class="hljs-keyword">import</span> ItemModel

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = ItemModel.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item.json()
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> ItemModel.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    item = ItemModel(name, data[<span class="hljs-string">'price'</span>])

    <span class="hljs-keyword">try</span>:
      item.save_to_db()
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item.json(), <span class="hljs-number">201</span> 

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
  item = ItemModel.find_by_name(name)
  <span class="hljs-keyword">if</span> item:
    item.delete_from_db()
  <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Item Deleted"</span>}


  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = ItemModel.find_by_name(name)
    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      item = ItemModel(name, data[<span class="hljs-string">'price'</span>])
    <span class="hljs-keyword">else</span>:
      item.price = data[<span class="hljs-string">'price'</span>]
    
    item.save_to_db()
    <span class="hljs-keyword">return</span> item.json()


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-comment"># connection = sqlite3.connect('data.db')</span>
    <span class="hljs-comment"># cursor = connection.cursor()</span>

    <span class="hljs-comment"># query = "SELECT * FROM items"</span>
    <span class="hljs-comment"># result = cursor.execute(query)</span>
    <span class="hljs-comment"># items = []</span>
    <span class="hljs-comment"># for row in result:</span>
    <span class="hljs-comment">#   items.append(</span>
    <span class="hljs-comment">#     {'name': row[0], 'price': row[1]}</span>
    <span class="hljs-comment">#   )</span>

    <span class="hljs-comment"># connection.close()</span>

    <span class="hljs-comment"># return {'items': items}</span>

    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: [item.json() <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> ItemModel.query.all()]}
    <span class="hljs-comment"># all returns all the object in the database</span>
</code></pre>
<h3 class="code-line" data-line-start=2713 data-line-end=2714><a id="No_more_creating_tables_manually_2713"></a>No more creating tables manually</h3>
<h5 class="code-line" data-line-start=2715 data-line-end=2716><a id="apppy_2715"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="2718" data-line-end="2752" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList

app = Flask(__name__)

app.config[<span class="hljs-string">'SQLALCHEMY_DATABSE_URI'</span>] = <span class="hljs-string">'sqlite:///data.db'</span>
app.config[<span class="hljs-string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="hljs-keyword">False</span>

app.secret_key = <span class="hljs-string">"secret_key"</span>
api = Api(app)

<span class="hljs-decorator">@app.before_first_request</span>
<span class="hljs-comment"># this is a flask request</span>
<span class="hljs-comment"># app.py will run the function below it before initializing the app</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_tables</span><span class="hljs-params">()</span>:</span>
  db.create_all()
  <span class="hljs-comment"># this references to the sqlite command above.</span>

jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>
api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>)

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">"__main__"</span>:
  <span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db
  db.init_app(app)
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)

</code></pre>
<h3 class="code-line" data-line-start=2753 data-line-end=2754><a id="Creating_a_new_StoreModel_2753"></a>Creating a new StoreModel</h3>
<h5 class="code-line" data-line-start=2756 data-line-end=2757><a id="modelsstorepy_2756"></a>models/store.py</h5>
<p class="has-line-data" data-line-start="2758" data-line-end="2759">copy pasted from models/item.py with some changes</p>
<pre><code class="has-line-data" data-line-start="2761" data-line-end="2787" class="language-python"><span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StoreModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  name = db.Column(db.String(<span class="hljs-number">80</span>)) <span class="hljs-comment">#changed</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name <span class="hljs-comment">#changed</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self:name, <span class="hljs-string">'items'</span>: self.items} <span class="hljs-comment">#changed</span>

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    <span class="hljs-keyword">return</span> cls.query.filter_by(name=name).first()
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.add(self)
    db.session.commit()
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.delete(self)
    db.session.commit()
</code></pre>
<h5 class="code-line" data-line-start=2788 data-line-end=2789><a id="modelsitempy_2788"></a>models/item.py</h5>
<pre><code class="has-line-data" data-line-start="2791" data-line-end="2833" class="language-python"><span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  name = db.Column(db.String(<span class="hljs-number">80</span>))
  price = db.Column(db.Float(precision=<span class="hljs-number">2</span>))

  store_id = db.column(db.Integer, db.ForeignKey(<span class="hljs-string">'stores.id'</span>))
  <span class="hljs-comment"># we are putting the select item in the select store</span>
  <span class="hljs-comment"># we are grouping items based on the storeid</span>
  <span class="hljs-comment"># this is a link created by store.id</span>
  <span class="hljs-comment"># store.id is the primary key of another db</span>
  <span class="hljs-comment"># where there is foreign key reference you cannot delete the main source</span>
  <span class="hljs-comment"># main source where it is a primary key</span>
  <span class="hljs-comment"># you first need to delete the foreign key reference</span>
  <span class="hljs-comment"># then delete that main source</span>
  store = db.relationship(<span class="hljs-string">'StoreModel'</span>)
  <span class="hljs-comment"># this connects the db for the foreign key stuff</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name
    self.price = price
    self.store_id = store_id
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self.name, <span class="hljs-string">'price'</span>: self.price}

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    <span class="hljs-keyword">return</span> cls.query.filter_by(name=name).first()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.add(self)
    db.session.commit()

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.delete(self)
    db.session.commit()

</code></pre>
<h5 class="code-line" data-line-start=2834 data-line-end=2835><a id="modelsstorepy_2834"></a>models/store.py</h5>
<p class="has-line-data" data-line-start="2836" data-line-end="2837">copy pasted from models/item.py with some changes</p>
<pre><code class="has-line-data" data-line-start="2839" data-line-end="2883" class="language-python"><span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StoreModel</span><span class="hljs-params">(db.Model)</span>:</span>
  __tablename__ = <span class="hljs-string">'items'</span>

  id = db.Column(db.Integer, primary_key=<span class="hljs-keyword">True</span>)
  name = db.Column(db.String(<span class="hljs-number">80</span>))

  items = db.relationship(<span class="hljs-string">'ItemModel'</span>, lazy=<span class="hljs-string">'dynamic'</span>)
  <span class="hljs-comment"># This is a backreference</span>
  <span class="hljs-comment"># This is a list</span>
  <span class="hljs-comment"># this many to one relationship</span>
  <span class="hljs-comment"># we are now getting back a list of items based on the foreign key relationship</span>
  <span class="hljs-comment"># But this is a greedy operation</span>
  <span class="hljs-comment"># When we have a lot of data this could result in a slow operation</span>
  <span class="hljs-comment"># So, we added the lazy dynamic thing</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, name, price)</span>:</span>
    self.name = name

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">json</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-comment"># return {'name': self:name, 'items': [item.json() for item in self.items]}</span>
    <span class="hljs-comment"># this is a fine statement if we didn't have lazy dynamic</span>
    <span class="hljs-comment"># but lazydynamic converts the self.items to not a list but a query builder</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'name'</span>: self:name, <span class="hljs-string">'items'</span>: [item.json() <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> self.items.all()]}
    <span class="hljs-comment"># by adding all() we are converting the query builder to an actual list</span>
    <span class="hljs-comment"># now there is a catch</span>
    <span class="hljs-comment"># without lazydynamic, we access the table once, and we don't repeat</span>
    <span class="hljs-comment"># with lazydynamic, we don't access the table until we do access the json()</span>
    <span class="hljs-comment"># but we keep access the table everytime we trigger the json function</span>
    <span class="hljs-comment"># There is  tradeoff of speed of creation and speed calling the json() function</span>

<span class="hljs-decorator">  @classmethod</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">find_by_name</span><span class="hljs-params">(cls, name)</span>:</span>
    <span class="hljs-keyword">return</span> cls.query.filter_by(name=name).first()
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_to_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.add(self)
    db.session.commit()
  
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete_from_db</span><span class="hljs-params">(self)</span>:</span>
    db.session.delete(self)
    db.session.commit()
</code></pre>
<h5 class="code-line" data-line-start=2884 data-line-end=2885><a id="resourcesitempy_2884"></a>resources/item.py</h5>
<pre><code class="has-line-data" data-line-start="2887" data-line-end="2956" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource, reqparse
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> jwt_required
<span class="hljs-keyword">from</span> models.item <span class="hljs-keyword">import</span> ItemModel

Class Item(Resource):
  parser =  reqparse.RequestParser()
  parser.add_argument(
      <span class="hljs-string">'price'</span>,
      type=float,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"this field cannot be left empty"</span>
  )

  <span class="hljs-comment"># accounting for store_id</span>
  parser.add_argument(
      <span class="hljs-string">'store_id'</span>,
      type=int,
      required=<span class="hljs-keyword">True</span>,
      help=<span class="hljs-string">"every item needs an store id"</span>
  )
  <span class="hljs-comment"># now for ItemModel reference we have to pass the store_id</span>

<span class="hljs-decorator">  @jwt_required()</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self, name)</span>:</span>
    item = ItemModel.find_by_name()
    <span class="hljs-keyword">if</span> item:
      <span class="hljs-keyword">return</span> item.json()
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'item does not exist'</span>}, <span class="hljs-number">404</span>  

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> ItemModel.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">"An item with name '{}' already exists."</span>.format(name)}, <span class="hljs-number">400</span>
    
    data = Item.parser.parse_args()
    <span class="hljs-comment"># item = ItemModel(name, data['price'], data['store_id'])</span>
    item = ItemModel(name, **data)

    <span class="hljs-keyword">try</span>:
      item.save_to_db()
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'An error occurred'</span>},
    <span class="hljs-keyword">return</span> item.json(), <span class="hljs-number">201</span> 

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
  item = ItemModel.find_by_name(name)
  <span class="hljs-keyword">if</span> item:
    item.delete_from_db()
  <span class="hljs-keyword">return</span> {<span class="hljs-string">"message"</span>: <span class="hljs-string">"Item Deleted"</span>}


  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">put</span><span class="hljs-params">(self, name)</span>:</span>
    data = Item.parser.parse_args()

    item = ItemModel.find_by_name(name)
    <span class="hljs-keyword">if</span> item <span class="hljs-keyword">is</span> <span class="hljs-keyword">None</span>:
      <span class="hljs-comment"># item = ItemModel(name, data['price'], data['store_id'])</span>
      item = ItemModel(name, **data)
    <span class="hljs-keyword">else</span>:
      item.price = data[<span class="hljs-string">'price'</span>]
      item.store_id = data[<span class="hljs-string">'store_id'</span>]
    
    item.save_to_db()
    <span class="hljs-keyword">return</span> item.json()


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ItemList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'items'</span>: [item.json() <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> ItemModel.query.all()]}
</code></pre>
<h1 class="code-line" data-line-start=2957 data-line-end=2958><a id="Creating_Store_Resource_2957"></a>Creating Store Resource</h1>
<p class="has-line-data" data-line-start="2959" data-line-end="2960">Creating the file</p>
<h5 class="code-line" data-line-start=2961 data-line-end=2962><a id="resourcesstorepy_2961"></a>resources/store.py</h5>
<pre><code class="has-line-data" data-line-start="2964" data-line-end="2997" class="language-python"><span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Resource
<span class="hljs-keyword">from</span> models.store <span class="hljs-keyword">import</span> StoreModel

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Store</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(name)</span>:</span>
    store = StoreModel.find_by_name(name)
    <span class="hljs-keyword">if</span> store:
      <span class="hljs-keyword">return</span> store.json()
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'Store not found'</span>}, <span class="hljs-number">404</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">post</span><span class="hljs-params">(self, name)</span>:</span>
    <span class="hljs-keyword">if</span> StoreModel.find_by_name(name):
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'Store name exists'</span>}, <span class="hljs-number">400</span>

    store = StoreModel(name)
    <span class="hljs-keyword">try</span>:
      store.save_to_db()
    <span class="hljs-keyword">except</span>:
      <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'an error occured'</span>}, <span class="hljs-number">500</span>

    <span class="hljs-keyword">return</span> store.json(), <span class="hljs-number">201</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">delete</span><span class="hljs-params">(self, name)</span>:</span>
    store = StoreModel.find_by_name(name):
    <span class="hljs-keyword">if</span> store:
      store.delete_from_db()
    
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'message'</span>: <span class="hljs-string">'Store Deleted'</span>}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StoreList</span><span class="hljs-params">(Resource)</span>:</span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-keyword">return</span> {<span class="hljs-string">'stores'</span>: [store.json() <span class="hljs-keyword">for</span> store <span class="hljs-keyword">in</span> StoreModel.query.all()]}
</code></pre>
<h5 class="code-line" data-line-start=2998 data-line-end=2999><a id="apppy_2998"></a><a href="http://app.py">app.py</a></h5>
<pre><code class="has-line-data" data-line-start="3001" data-line-end="3037" class="language-python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask
<span class="hljs-keyword">from</span> flask_restful <span class="hljs-keyword">import</span> Api
<span class="hljs-keyword">from</span> flask_jwt <span class="hljs-keyword">import</span> JWT

<span class="hljs-keyword">from</span> security <span class="hljs-keyword">import</span> authenticate, identity
<span class="hljs-keyword">from</span> resources.user <span class="hljs-keyword">import</span> UserRegister
<span class="hljs-keyword">from</span> resources.item <span class="hljs-keyword">import</span> Item, ItemList
<span class="hljs-keyword">from</span> resources.store <span class="hljs-keyword">import</span> Store, StoreList <span class="hljs-comment">#changed</span>
<span class="hljs-comment"># app.py&gt; resource &gt; model &gt; db </span>

app = Flask(__name__)

app.config[<span class="hljs-string">'SQLALCHEMY_DATABSE_URI'</span>] = <span class="hljs-string">'sqlite:///data.db'</span>
app.config[<span class="hljs-string">'SQLALCHEMY_TRACK_MODIFICATIONS'</span>] = <span class="hljs-keyword">False</span>

app.secret_key = <span class="hljs-string">"secret_key"</span>
api = Api(app)

<span class="hljs-decorator">@app.before_first_request</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_tables</span><span class="hljs-params">()</span>:</span>
  db.create_all()

jwt = JWT(app, authenticate, identity) <span class="hljs-comment">#/auth</span>

api.add_resource(Store, <span class="hljs-string">'/store/&lt;string:name&gt;'</span>) <span class="hljs-comment">#changed</span>
api.add_resource(StoreList, <span class="hljs-string">'/stores'</span>) <span class="hljs-comment">#changed</span>
api.add_resource(Item, <span class="hljs-string">'/item/&lt;string:name&gt;'</span>)
api.add_resource(ItemList, <span class="hljs-string">'/items'</span>)
api.add_resource(UserRegister, <span class="hljs-string">'/register'</span>)

<span class="hljs-keyword">if</span> __name__ = <span class="hljs-string">"__main__"</span>:
  <span class="hljs-keyword">from</span> db <span class="hljs-keyword">import</span> db
  db.init_app(app)
  app.run(port=<span class="hljs-number">5000</span>, debug=<span class="hljs-keyword">True</span>)

</code></pre>
<h3 class="code-line" data-line-start=3038 data-line-end=3039><a id="Final_testing_3038"></a>Final testing</h3>
<p class="has-line-data" data-line-start="3040" data-line-end="3041">When reintializing always delete the data.db (<code>rm data.db</code>)</p>
<p class="has-line-data" data-line-start="3042" data-line-end="3043">When POSTing to item/name, remember to modify the request with the new store ID.</p>
<pre><code class="has-line-data" data-line-start="3045" data-line-end="3050" class="language-JSON">{
  "<span class="hljs-attribute">price</span>": <span class="hljs-value"><span class="hljs-number">15.99</span></span>,
  "<span class="hljs-attribute">store_id</span>": <span class="hljs-value"><span class="hljs-number">2</span>
</span>}
</code></pre>
<p class="has-line-data" data-line-start="3051" data-line-end="3052">Even though you may have not initialized the StoreModel (meaning that store_id reference has not been initialized and you are also working with foreign keys), SQLite3 just ignores that but that wont work with PostGres or MySQL.</p>
<p class="has-line-data" data-line-start="3053" data-line-end="3054">Now when you create the store with the store_id it will automatically adjust to that.</p>
<p class="has-line-data" data-line-start="3055" data-line-end="3056">store_id is auto increasing here. First POST request made in /store/test results in a store with an id of 1. Second request makes it another store with an id of 2 and this will result in the showing of the product.</p>
<p class="has-line-data" data-line-start="3057" data-line-end="3058">Create this new endpoints</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th>Request</th>
<th>Endpoint</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/store/&lt;name&gt;</td>
</tr>
<tr>
<td>POST</td>
<td>/store/&lt;name&gt;</td>
</tr>
<tr>
<td>DEL</td>
<td>/store/&lt;name&gt;</td>
</tr>
<tr>
<td>GET</td>
<td>/stores/</td>
</tr>
</tbody>
</table>
</body></html>